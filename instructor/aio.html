<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Data Management with Python for Ecologists: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="../assets/images/data-logo.svg"><abbr class="icon" title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team." style="text-decoration: unset">
           
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#polishing-beta-stage" class="external-link alert-link" style="color: #383838">Beta
            <i aria-hidden="true" class="icon" data-feather="alert-circle" style="color: #001483"></i>
          </a>
          <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container ">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="../assets/images/data-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Data Management with Python for Ecologists
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Data Management with Python for Ecologists
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Management with Python for Ecologists
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
  <div id="sidebar-col" class="col-lg-4">
    <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle"><i class="search-icon" data-feather="x" role="img"></i></button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introducing-python.html">1. Introducing Python</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-introducing-pandas.html">2. Introducing pandas</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-accessing-data-in-a-dataframe.html">3. Accessing Data in a Dataframe</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-aggregating-and-grouping-data.html">4. Aggregating and Grouping Data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-combining-data-with-joins.html">5. Combining Dataframes</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-introducing-python"><p>Content from <a href="01-introducing-python.html">Introducing Python</a></p>
<hr>
<p> Last updated on 2022-07-18 | <a href="https://github.com/adamancer/python-ecology-lesson-alt/edit/main/episodes/01-introducing-python.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 60 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is Python?</li>
<li>How do we assign variables in Python?</li>
<li>How do we perform actions in Python?</li>
<li>How does Python handle different types of data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Introduce some Python terminology</li>
<li>Learn how to assign values to variables</li>
<li>Learn how to use functions and methods</li>
<li>Introduce the built-in Python data types and functions</li>
<li>Introduce the Python Standard Library</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="about-python"><h2 class="section-heading">About Python<a class="anchor" aria-label="anchor" href="#about-python"></a>
</h2>
<hr class="half-width">
<p>Python is a high-level, general purpose language. In practical terms, that means it dispenses with many of the complexities of writing code. It is widely used and has an active community of developers, making it suitable for a large number of tasks.</p>
<p>A core philosophical tenet of Python is that code is read more often than it is written. Best practices for coding in Python therefore emphasize writing well-documented, consistently formatted code that follows language-wide standards. <strong>In a Pythonic world, everyone’s code would look the same.</strong></p>
<p>One feature to be aware of going in is that Python uses whitespace (as opposed to braces) to organize blocks of code. This can be a sticking point for people used to other languages.</p>
</section><section id="getting-started"><h2 class="section-heading">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<hr class="half-width">
<p>Everything in Python is an <em>object</em>. Each object has a type, which controls what the object can do. For example, we can add integers together or append a string to a list. An object can be <em>assigned</em> to a <em>variable</em>, and a <em>function</em> performs an action.</p>
<p>Python is an <em>object-oriented language</em>. This means that each object includes built-in variables and functions that can be used from the object itself. When working from an object, we use different terms to refer to these concepts:</p>
<ul>
<li>an <em>attribute</em> stores a piece of data</li>
<li>a <em>method</em> performs an action</li>
</ul>
<p>Let’s look at one of the main built-in types, <code>str</code>, to see how this works in practice. In Python, <code>str</code>, short for string, is used to store and manipulate text. To get started, we’ll assign the string “hello world” to the variable <strong>text</strong>. In Python, we use a single equal sign for assignment and quotes to create a string.</p>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="using-quotes" class="callout-inner">
<h3 class="callout-title">Using quotes<a class="anchor" aria-label="anchor" href="#using-quotes"></a>
</h3>
<div class="callout-content">
<p>Either single or double quotes can be used to create strings, but try to use them consistently! We will use double quotes in the examples here.</p>
</div>
</div>
</div>
<p>First we’ll define a variable called text. Variables can be any type of object supported by Python, but in this case we’ll use a string:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">"hello world"</span></span></code></pre>
</div>
<p>Now, instead of retyping the full string every time we need it, we can access that string by referring to the variable:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>text</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">'hello world'</span></span></code></pre>
</div>
<p>We can check the type of the variable using the <code>type()</code> function:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(text)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">str</span></span></code></pre>
</div>
<p>We can modify the text by calling one of the methods built into the <code>str</code> class. We call methods by appending a period and the name of the method to the object. For example, to display the string in upper case, use <code>upper()</code>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>text.upper()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">'HELLO WORLD'</span></span></code></pre>
</div>
<p>After running a cell, Jupyter displays a representation of the object that appears in the last line of a cell (but note that some actions, like assigning an object, have no output). Some cells will have more than one line, and it is often useful to display content produced earlier in a cell. This can be accomplished using the built-in <code>print()</code> function. In the cell below, we’ll use <code>print()</code> to show a series of strings:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">"hello"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"h"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"e"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"l"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"l"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"o"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">"world"</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">h</span></span>
<span><span class="va">e</span></span>
<span><span class="va">l</span></span>
<span><span class="va">l</span></span>
<span><span class="va">o</span></span>
<span></span>
<span><span class="st">'world'</span></span></code></pre>
</div>
<p>Note that the string “hello” at the top of the cell lacks a print statement and does not appear in the output, whereas the text “world” <em>does</em> appear in the output because it is the last line of the cell.</p>
<p>Each object may contain many attributes and methods. Use the <code>help()</code> function on any object, including functions or methods, to show a description of the object and list the available methods.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">help</span>(<span class="bu">str</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Help on class str in module builtins:

class str(object)
 |  str(object='') -&gt; str
 |  str(bytes_or_buffer[, encoding[, errors]]) -&gt; str
 |  
 |  Create a new string object from the given object. If encoding or
 |  errors is specified, then the object must expose a data buffer
 |  that will be decoded using the given encoding and error handler.
 |  Otherwise, returns the result of object.__str__() (if defined)
 |  or repr(object).
 |  encoding defaults to sys.getdefaultencoding().
 |  errors defaults to 'strict'.
 |  
 |  Methods defined here:
 |  
 |  __add__(self, value, /)
 |      Return self+value.
 |  
 |  __contains__(self, key, /)
 |      Return key in self.
 |  
 |  __eq__(self, value, /)
 |      Return self==value.
 |  
 |  __format__(self, format_spec, /)
 |      Return a formatted version of the string as described by format_spec.
 |  
 |  __ge__(self, value, /)
 |      Return self&gt;=value.
 |  
 |  __getattribute__(self, name, /)
 |      Return getattr(self, name).
 |  
 |  __getitem__(self, key, /)
 |      Return self[key].
 |  
 |  __getnewargs__(...)
 |  
 |  __gt__(self, value, /)
 |      Return self&gt;value.
 |  
 |  __hash__(self, /)
 |      Return hash(self).
 |  
 |  __iter__(self, /)
 |      Implement iter(self).
 |  
 |  __le__(self, value, /)
 |      Return self&lt;=value.
 |  
 |  __len__(self, /)
 |      Return len(self).
 |  
 |  __lt__(self, value, /)
 |      Return self&lt;value.
 |  
 |  __mod__(self, value, /)
 |      Return self%value.
 |  
 |  __mul__(self, value, /)
 |      Return self*value.
 |  
 |  __ne__(self, value, /)
 |      Return self!=value.
 |  
 |  __repr__(self, /)
 |      Return repr(self).
 |  
 |  __rmod__(self, value, /)
 |      Return value%self.
 |  
 |  __rmul__(self, value, /)
 |      Return value*self.
 |  
 |  __sizeof__(self, /)
 |      Return the size of the string in memory, in bytes.
 |  
 |  __str__(self, /)
 |      Return str(self).
 |  
 |  capitalize(self, /)
 |      Return a capitalized version of the string.
 |      
 |      More specifically, make the first character have upper case and the rest lower
 |      case.
 |  
 |  casefold(self, /)
 |      Return a version of the string suitable for caseless comparisons.
 |  
 |  center(self, width, fillchar=' ', /)
 |      Return a centered string of length width.
 |      
 |      Padding is done using the specified fill character (default is a space).
 |  
 |  count(...)
 |      S.count(sub[, start[, end]]) -&gt; int
 |      
 |      Return the number of non-overlapping occurrences of substring sub in
 |      string S[start:end].  Optional arguments start and end are
 |      interpreted as in slice notation.
 |  
 |  encode(self, /, encoding='utf-8', errors='strict')
 |      Encode the string using the codec registered for encoding.
 |      
 |      encoding
 |        The encoding in which to encode the string.
 |      errors
 |        The error handling scheme to use for encoding errors.
 |        The default is 'strict' meaning that encoding errors raise a
 |        UnicodeEncodeError.  Other possible values are 'ignore', 'replace' and
 |        'xmlcharrefreplace' as well as any other name registered with
 |        codecs.register_error that can handle UnicodeEncodeErrors.
 |  
 |  endswith(...)
 |      S.endswith(suffix[, start[, end]]) -&gt; bool
 |      
 |      Return True if S ends with the specified suffix, False otherwise.
 |      With optional start, test S beginning at that position.
 |      With optional end, stop comparing S at that position.
 |      suffix can also be a tuple of strings to try.
 |  
 |  expandtabs(self, /, tabsize=8)
 |      Return a copy where all tab characters are expanded using spaces.
 |      
 |      If tabsize is not given, a tab size of 8 characters is assumed.
 |  
 |  find(...)
 |      S.find(sub[, start[, end]]) -&gt; int
 |      
 |      Return the lowest index in S where substring sub is found,
 |      such that sub is contained within S[start:end].  Optional
 |      arguments start and end are interpreted as in slice notation.
 |      
 |      Return -1 on failure.
 |  
 |  format(...)
 |      S.format(*args, **kwargs) -&gt; str
 |      
 |      Return a formatted version of S, using substitutions from args and kwargs.
 |      The substitutions are identified by braces ('{' and '}').
 |  
 |  format_map(...)
 |      S.format_map(mapping) -&gt; str
 |      
 |      Return a formatted version of S, using substitutions from mapping.
 |      The substitutions are identified by braces ('{' and '}').
 |  
 |  index(...)
 |      S.index(sub[, start[, end]]) -&gt; int
 |      
 |      Return the lowest index in S where substring sub is found,
 |      such that sub is contained within S[start:end].  Optional
 |      arguments start and end are interpreted as in slice notation.
 |      
 |      Raises ValueError when the substring is not found.
 |  
 |  isalnum(self, /)
 |      Return True if the string is an alpha-numeric string, False otherwise.
 |      
 |      A string is alpha-numeric if all characters in the string are alpha-numeric and
 |      there is at least one character in the string.
 |  
 |  isalpha(self, /)
 |      Return True if the string is an alphabetic string, False otherwise.
 |      
 |      A string is alphabetic if all characters in the string are alphabetic and there
 |      is at least one character in the string.
 |  
 |  isascii(self, /)
 |      Return True if all characters in the string are ASCII, False otherwise.
 |      
 |      ASCII characters have code points in the range U+0000-U+007F.
 |      Empty string is ASCII too.
 |  
 |  isdecimal(self, /)
 |      Return True if the string is a decimal string, False otherwise.
 |      
 |      A string is a decimal string if all characters in the string are decimal and
 |      there is at least one character in the string.
 |  
 |  isdigit(self, /)
 |      Return True if the string is a digit string, False otherwise.
 |      
 |      A string is a digit string if all characters in the string are digits and there
 |      is at least one character in the string.
 |  
 |  isidentifier(self, /)
 |      Return True if the string is a valid Python identifier, False otherwise.
 |      
 |      Call keyword.iskeyword(s) to test whether string s is a reserved identifier,
 |      such as "def" or "class".
 |  
 |  islower(self, /)
 |      Return True if the string is a lowercase string, False otherwise.
 |      
 |      A string is lowercase if all cased characters in the string are lowercase and
 |      there is at least one cased character in the string.
 |  
 |  isnumeric(self, /)
 |      Return True if the string is a numeric string, False otherwise.
 |      
 |      A string is numeric if all characters in the string are numeric and there is at
 |      least one character in the string.
 |  
 |  isprintable(self, /)
 |      Return True if the string is printable, False otherwise.
 |      
 |      A string is printable if all of its characters are considered printable in
 |      repr() or if it is empty.
 |  
 |  isspace(self, /)
 |      Return True if the string is a whitespace string, False otherwise.
 |      
 |      A string is whitespace if all characters in the string are whitespace and there
 |      is at least one character in the string.
 |  
 |  istitle(self, /)
 |      Return True if the string is a title-cased string, False otherwise.
 |      
 |      In a title-cased string, upper- and title-case characters may only
 |      follow uncased characters and lowercase characters only cased ones.
 |  
 |  isupper(self, /)
 |      Return True if the string is an uppercase string, False otherwise.
 |      
 |      A string is uppercase if all cased characters in the string are uppercase and
 |      there is at least one cased character in the string.
 |  
 |  join(self, iterable, /)
 |      Concatenate any number of strings.
 |      
 |      The string whose method is called is inserted in between each given string.
 |      The result is returned as a new string.
 |      
 |      Example: '.'.join(['ab', 'pq', 'rs']) -&gt; 'ab.pq.rs'
 |  
 |  ljust(self, width, fillchar=' ', /)
 |      Return a left-justified string of length width.
 |      
 |      Padding is done using the specified fill character (default is a space).
 |  
 |  lower(self, /)
 |      Return a copy of the string converted to lowercase.
 |  
 |  lstrip(self, chars=None, /)
 |      Return a copy of the string with leading whitespace removed.
 |      
 |      If chars is given and not None, remove characters in chars instead.
 |  
 |  partition(self, sep, /)
 |      Partition the string into three parts using the given separator.
 |      
 |      This will search for the separator in the string.  If the separator is found,
 |      returns a 3-tuple containing the part before the separator, the separator
 |      itself, and the part after it.
 |      
 |      If the separator is not found, returns a 3-tuple containing the original string
 |      and two empty strings.
 |  
 |  removeprefix(self, prefix, /)
 |      Return a str with the given prefix string removed if present.
 |      
 |      If the string starts with the prefix string, return string[len(prefix):].
 |      Otherwise, return a copy of the original string.
 |  
 |  removesuffix(self, suffix, /)
 |      Return a str with the given suffix string removed if present.
 |      
 |      If the string ends with the suffix string and that suffix is not empty,
 |      return string[:-len(suffix)]. Otherwise, return a copy of the original
 |      string.
 |  
 |  replace(self, old, new, count=-1, /)
 |      Return a copy with all occurrences of substring old replaced by new.
 |      
 |        count
 |          Maximum number of occurrences to replace.
 |          -1 (the default value) means replace all occurrences.
 |      
 |      If the optional argument count is given, only the first count occurrences are
 |      replaced.
 |  
 |  rfind(...)
 |      S.rfind(sub[, start[, end]]) -&gt; int
 |      
 |      Return the highest index in S where substring sub is found,
 |      such that sub is contained within S[start:end].  Optional
 |      arguments start and end are interpreted as in slice notation.
 |      
 |      Return -1 on failure.
 |  
 |  rindex(...)
 |      S.rindex(sub[, start[, end]]) -&gt; int
 |      
 |      Return the highest index in S where substring sub is found,
 |      such that sub is contained within S[start:end].  Optional
 |      arguments start and end are interpreted as in slice notation.
 |      
 |      Raises ValueError when the substring is not found.
 |  
 |  rjust(self, width, fillchar=' ', /)
 |      Return a right-justified string of length width.
 |      
 |      Padding is done using the specified fill character (default is a space).
 |  
 |  rpartition(self, sep, /)
 |      Partition the string into three parts using the given separator.
 |      
 |      This will search for the separator in the string, starting at the end. If
 |      the separator is found, returns a 3-tuple containing the part before the
 |      separator, the separator itself, and the part after it.
 |      
 |      If the separator is not found, returns a 3-tuple containing two empty strings
 |      and the original string.
 |  
 |  rsplit(self, /, sep=None, maxsplit=-1)
 |      Return a list of the words in the string, using sep as the delimiter string.
 |      
 |        sep
 |          The delimiter according which to split the string.
 |          None (the default value) means split according to any whitespace,
 |          and discard empty strings from the result.
 |        maxsplit
 |          Maximum number of splits to do.
 |          -1 (the default value) means no limit.
 |      
 |      Splits are done starting at the end of the string and working to the front.
 |  
 |  rstrip(self, chars=None, /)
 |      Return a copy of the string with trailing whitespace removed.
 |      
 |      If chars is given and not None, remove characters in chars instead.
 |  
 |  split(self, /, sep=None, maxsplit=-1)
 |      Return a list of the words in the string, using sep as the delimiter string.
 |      
 |      sep
 |        The delimiter according which to split the string.
 |        None (the default value) means split according to any whitespace,
 |        and discard empty strings from the result.
 |      maxsplit
 |        Maximum number of splits to do.
 |        -1 (the default value) means no limit.
 |  
 |  splitlines(self, /, keepends=False)
 |      Return a list of the lines in the string, breaking at line boundaries.
 |      
 |      Line breaks are not included in the resulting list unless keepends is given and
 |      true.
 |  
 |  startswith(...)
 |      S.startswith(prefix[, start[, end]]) -&gt; bool
 |      
 |      Return True if S starts with the specified prefix, False otherwise.
 |      With optional start, test S beginning at that position.
 |      With optional end, stop comparing S at that position.
 |      prefix can also be a tuple of strings to try.
 |  
 |  strip(self, chars=None, /)
 |      Return a copy of the string with leading and trailing whitespace removed.
 |      
 |      If chars is given and not None, remove characters in chars instead.
 |  
 |  swapcase(self, /)
 |      Convert uppercase characters to lowercase and lowercase characters to uppercase.
 |  
 |  title(self, /)
 |      Return a version of the string where each word is titlecased.
 |      
 |      More specifically, words start with uppercased characters and all remaining
 |      cased characters have lower case.
 |  
 |  translate(self, table, /)
 |      Replace each character in the string using the given translation table.
 |      
 |        table
 |          Translation table, which must be a mapping of Unicode ordinals to
 |          Unicode ordinals, strings, or None.
 |      
 |      The table must implement lookup/indexing via __getitem__, for instance a
 |      dictionary or list.  If this operation raises LookupError, the character is
 |      left untouched.  Characters mapped to None are deleted.
 |  
 |  upper(self, /)
 |      Return a copy of the string converted to uppercase.
 |  
 |  zfill(self, width, /)
 |      Pad a numeric string with zeros on the left, to fill a field of the given width.
 |      
 |      The string is never truncated.
 |  
 |  ----------------------------------------------------------------------
 |  Static methods defined here:
 |  
 |  __new__(*args, **kwargs) from builtins.type
 |      Create and return a new object.  See help(type) for accurate signature.
 |  
 |  maketrans(...)
 |      Return a translation table usable for str.translate().
 |      
 |      If there is only one argument, it must be a dictionary mapping Unicode
 |      ordinals (integers) or characters to Unicode ordinals, strings or None.
 |      Character keys will be then converted to ordinals.
 |      If there are two arguments, they must be strings of equal length, and
 |      in the resulting dictionary, each character in x will be mapped to the
 |      character at the same position in y. If there is a third argument, it
 |      must be a string, whose characters will be mapped to None in the result.

</code></pre>
</div>
<div class="section level3">
<h3 id="data-types">Data types<a class="anchor" aria-label="anchor" href="#data-types"></a>
</h3>
<p>Python also includes data types for representing other types of data, including numbers or collections of data. The core Python data types are introduced in the table below. We’ll talk more about some of these as we encounter them in the lesson:</p>
<table style="width:99%;" class="table">
<colgroup>
<col width="45%">
<col width="13%">
<col width="39%">
</colgroup>
<thead><tr class="header">
<th align="left">Type</th>
<th align="left">Definition</th>
<th align="left">Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><a href="https://docs.python.org/3/library/stdtypes.html#textseq" class="external-link">str</a></td>
<td align="left">Character string</td>
<td align="left"><code>"hello world"</code></td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.python.org/3/library/functions.html#int" class="external-link">int</a></td>
<td align="left">Integer numerical</td>
<td align="left"><code>42</code></td>
</tr>
<tr class="odd">
<td align="left"><a href="https://docs.python.org/3/library/functions.html#float" class="external-link">float</a></td>
<td align="left">Approximate numerical</td>
<td align="left"><code>0.406</code></td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.python.org/3/library/functions.html#bool" class="external-link">bool</a></td>
<td align="left">Stores True or False values</td>
<td align="left">
<code>True</code> or <code>False</code>
</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://docs.python.org/3/library/stdtypes.html#lists" class="external-link">list</a></td>
<td align="left">Sequence that can be modified</td>
<td align="left"><code>["a", "b", "c"]</code></td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.python.org/3/library/stdtypes.html#tuples" class="external-link">tuple</a></td>
<td align="left">Sequence that cannot be modified</td>
<td align="left"><code>("a", "b", "c")</code></td>
</tr>
<tr class="odd">
<td align="left"><a href="https://docs.python.org/3/library/stdtypes.html#mapping-types-dict" class="external-link">dict</a></td>
<td align="left">Mapping of keys to values</td>
<td align="left"><code>{"DC": "District of Columbia", "MD": "Maryland", "VA": "Virginia"}</code></td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.python.org/3/library/stdtypes.html#set-types-set-frozenset" class="external-link">set</a></td>
<td align="left">Collection of unique values</td>
<td align="left"><code>{"1", "2", 1}</code></td>
</tr>
</tbody>
</table>
</div>
</section><section id="libraries"><h2 class="section-heading">Libraries<a class="anchor" aria-label="anchor" href="#libraries"></a>
</h2>
<hr class="half-width">
<p>Python includes a number of <a href="https://docs.python.org/3/library/functions.html" class="external-link">built-in functions</a> that are available wherever Python is installed. See the table below for some examples.</p>
<div class="section level3">
<h3 id="examples-of-built-in-functions">Examples of built-in functions<a class="anchor" aria-label="anchor" href="#examples-of-built-in-functions"></a>
</h3>
<table style="width:98%;" class="table">
<colgroup>
<col width="55%">
<col width="18%">
<col width="24%">
</colgroup>
<thead><tr class="header">
<th align="left">Name</th>
<th align="left">Description</th>
<th align="left">Example</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><a href="https://docs.python.org/3/library/functions.html#abs" class="external-link"><code>abs()</code></a></td>
<td align="left">Gets the absolute value of a number</td>
<td align="left"><code>abs(-1.5) # returns 1.5</code></td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.python.org/3/library/functions.html#max" class="external-link"><code>max()</code></a></td>
<td align="left">Gets the highest value in a sequence</td>
<td align="left"><code>min([1, 2, 3]) # returns 3</code></td>
</tr>
<tr class="odd">
<td align="left"><a href="https://docs.python.org/3/library/functions.html#min" class="external-link"><code>min()</code></a></td>
<td align="left">Gets the lowest value in a sequence</td>
<td align="left"><code>min([1, 2, 3]) # returns 1</code></td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.python.org/3/library/functions.html#round" class="external-link"><code>round()</code></a></td>
<td align="left">Rounds a number to the nearest integer</td>
<td align="left"><code>round(5.4) # returns 5</code></td>
</tr>
</tbody>
</table>
<p>Python also includes a number of built-in libraries. A <em>library</em> bundles functions and other code related to a single task or data type. They are used to simplify the performance of common tasks. By using a common code base, a library allows coders to work more quickly and with fewer errors.</p>
<p>The libraries built into Python are referred to as the <a href="https://docs.python.org/3/library/index.html" class="external-link">Python Standard Library</a>. They can be accessed through a typical Python installation and do not require any additional downloads. A few examples are included in the table below, but as with the table of built-in functions, there are more where those came from.</p>
</div>
<div class="section level3">
<h3 id="examples-from-the-python-standard-library">Examples from the Python Standard Library<a class="anchor" aria-label="anchor" href="#examples-from-the-python-standard-library"></a>
</h3>
<table style="width:98%;" class="table">
<colgroup>
<col width="62%">
<col width="36%">
</colgroup>
<thead><tr class="header">
<th align="left">Library</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><a href="https://docs.python.org/3/library/datetime.html" class="external-link">datetime</a></td>
<td align="left">Reads, writes, and analyzes dates and times</td>
</tr>
<tr class="even">
<td align="left"><a href="https://docs.python.org/3/library/os.html" class="external-link">os</a></td>
<td align="left">Create, manipulate, and get information about files and paths</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://docs.python.org/3/library/random.html" class="external-link">random</a></td>
<td align="left">Generate pseudo-random numbers</td>
</tr>
</tbody>
</table>
<div id="callout2" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="documentation" class="callout-inner">
<h3 class="callout-title">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h3>
<div class="callout-content">
<p>The documentation for each library can be viewed by clicking the link in the table. Documentation is an invaluable resource. It provides descriptions of what a library does and detailed information about how it can be used, often including examples.</p>
</div>
</div>
</div>
<p>Unlike the built-in functions, we must import a library before we can use it. We do so using the <code>import</code> statement:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime</span></code></pre>
</div>
<p>Once imported, the library is available for use anywhere in the current document. When using a library, we must include the name of the library to access its functions. For example, to create a <code>datetime.date</code> object (that is, a <code>date</code> object defined by the <code>datetime</code> library), we include both the library and method name:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>date <span class="op">=</span> datetime.date(<span class="dv">1970</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span></code></pre>
</div>
<p>As with the built-in types, the <code>datetime.date</code> object includes its own suite of attributes and methods. We can, for example, use the year attribute to get the year:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>date.year</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1970</span></span></code></pre>
</div>
<p>Or convert the date to a string using the <a href="https://docs.python.org/3/library/datetime.html#datetime.date.strftime" class="external-link"><code>strftime()</code></a> method and <a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes" class="external-link">date format codes</a>. Here, %Y corresponds to YYYY, %m to MM, and %d to DD.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>date.strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">'1970-01-01'</span></span></code></pre>
</div>
<p>Like Python itself, the Python Standard Library is maintained by the Python Software Foundation. The built-in libraries are limited to a relatively small set of operations expected to be useful to a broad population of users. However, Python allows users to create their own libraries to perform actions that are beyond the scope of core Python. The rest of this lesson will focus on an external library called pandas.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<ul>
<li>Python is a widely used language that can be used for a variety of tasks, including analyzing data</li>
<li>Python uses different data types to handle text, numbers, collections, and other kinds of data</li>
<li>Assign values to variables using the <code>=</code> operator</li>
<li>Use functions and methods to perform specific actions</li>
<li>Python’s functionality can be extended using libraries, including libraries written by members of the community that address discipline-specific needs</li>
<li>Use the <code>help()</code> function and developer documentation to learn more about Python and Python libraries</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</section></section><section id="aio-02-introducing-pandas"><p>Content from <a href="02-introducing-pandas.html">Introducing pandas</a></p>
<hr>
<p> Last updated on 2022-07-18 | <a href="https://github.com/adamancer/python-ecology-lesson-alt/edit/main/episodes/02-introducing-pandas.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 60 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What data will we be working with in this lesson?</li>
<li>What is pandas?</li>
<li>Why use pandas for data analysis?</li>
<li>How do we read and write data using pandas?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn about the dataset we’ll be working with</li>
<li>Look at the benefits of using pandas to analyze data</li>
<li>Import data from a CSV into a pandas dataframe</li>
<li>Learn how pandas handles different types of data</li>
<li>Write a dataframe to a CSV</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="dataset-description"><h2 class="section-heading">Dataset description<a class="anchor" aria-label="anchor" href="#dataset-description"></a>
</h2>
<hr class="half-width">
<p><em>The dataset description was taken from <a href="https://datacarpentry.org/sql-ecology-lesson/" class="external-link">Data Management with SQL for Ecologists</a> (CC-BY-4.0)</em></p>
<p>The data we will be using is a time-series for a small mammal community in southern Arizona. This is part of a project studying the effects of rodents and ants on the plant community that has been running for almost 40 years. The rodents are sampled on a series of 24 plots, with different experimental manipulations controlling which rodents are allowed to access which plots.</p>
<p>This is a real dataset that has been used in over 100 publications. We’ve simplified it for the workshop, but you can download the full dataset and work with it using exactly the same tools we’ll learn about today.</p>
</section><section id="answering-questions-using-data"><h2 class="section-heading">Answering questions using data<a class="anchor" aria-label="anchor" href="#answering-questions-using-data"></a>
</h2>
<hr class="half-width">
<p>Let’s look at some of the cleaned spreadsheets we downloaded during Setup to complete this challenge. We’ll need the following two files:</p>
<ul>
<li>surveys.csv</li>
<li>species.csv</li>
</ul>
<div id="discussion1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<p>Open each of these csv files and explore them. What information is contained in each file? Specifically, if we had the following research questions:</p>
<ul>
<li>How has the hindfoot length and weight of Dipodomys species changed over time?</li>
<li>What is the average weight of each species, per year?</li>
<li>What information can I learn about Dipodomys species in the 2000s, over time?</li>
</ul>
<p>What would we need to answer these questions? Which files have the data we need? What operations would we need to perform if we were doing these analyses by hand?</p>
<p><strong>Hint:</strong> We can view CSV files using JupyterLab using the left sidebar. Click on the Folder icon in the top left of the sidebar to see the files, then go to the data directory to see the CSV we’ve downloaded for this lesson.</p>
</div>
</div>
</div>
<p>In order to answer the questions described above, we’ll need to do the following basic data operations:</p>
<ul>
<li>select subsets of the data (rows and columns)</li>
<li>group subsets of data</li>
<li>do math and other calculations</li>
<li>combine data across spreadsheets</li>
</ul>
<p>In addition, we don’t want to do this manually! Instead of searching for the right pieces of data ourselves, or clicking between spreadsheets, or manually sorting columns, we want to make the computer do the work.</p>
<p>In particular, we want to use a tool where it’s easy to repeat our analysis in case our data changes. We also want to do all this searching without actually modifying our source data.</p>
</section><section id="why-use-pandas"><h2 class="section-heading">Why use pandas?<a class="anchor" aria-label="anchor" href="#why-use-pandas"></a>
</h2>
<hr class="half-width">
<p>The Python Data Analysis Library, or pandas, is a Python library used to work with dataframes. A dataframe is a representation of tabular data very similar to a spreadsheet, consisting of rows (representing records) and columns (representing fields or variables). It is a very common format for representing scientific data and is likely to be very familiar to anyone taking this course.</p>
<p>pandas offers the same advantages as any well-written library: It creates a common codebase for working on a single task, in this case, analyzing data. Some benefits of this approach include:</p>
<ul>
<li>
<strong>Reliability:</strong> Provides flexible, well-tested methods for reading, querying, aggregating, grouping, and plotting data</li>
<li>
<strong>Repeatability:</strong> Repeat the same analyses when data is added or changed</li>
<li>
<strong>Speed:</strong> Faster in many cases than coding our own functions in Python</li>
<li>
<strong>Reproducibility:</strong> Document and share code in narrative form using tools like Jupyter notebooks</li>
<li>
<strong>Community:</strong> Access a large, active community for help when we run into problems</li>
</ul></section><section id="importing-data-using-pandas"><h2 class="section-heading">Importing data using pandas<a class="anchor" aria-label="anchor" href="#importing-data-using-pandas"></a>
</h2>
<hr class="half-width">
<p>Unlike the libraries in the Python Standard Library discussed in the previous lesson, pandas is not part of the typical Python installation. Once it has been installed, however, it can be accessed using the same <code>import</code> command used to import the built-in libraries. By convention, pandas is imported using the alias “pd”. We can assign the alias using the <code>as</code> keyword:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre>
</div>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="using-aliases" class="callout-inner">
<h3 class="callout-title">Using aliases<a class="anchor" aria-label="anchor" href="#using-aliases"></a>
</h3>
<div class="callout-content">
<p>Why use an alias? We will refer to pandas many, many times when writing a script, so it’s useful to abbreviate the name and save some keystrokes. But it’s also a matter of consistency with the larger community. Many of the core scientific Python libraries, including pandas, recommend a specific alias, so most code shared online will use those aliases as well.</p>
</div>
</div>
</div>
<p>Now that pandas has been imported, we can access the function we need to load data from a CSV, <code>pd.read_csv()</code>. The function call has three parts:</p>
<ul>
<li>The name (or in this case, alias) of the object that defines the function. This can be a library or any other object. It can also be omitted in some cases (for example, when using a function built into Python).</li>
<li>The name of the method we’d like to use</li>
<li>A set of parentheses that tells the function to run.</li>
</ul>
<p>Many functions define <em>parameters</em> that allow the user to modify the behavior of the function. Parameters may be positional or named. In Python, data passed to positional parameters are called <em>arguments</em> (often abbreviated as args), and data passed to named parameters are called <em>keyword arguments</em> (often abbreviated as kwargs). In either case, the arguments are included inside the parentheses used to call the function.</p>
<p>Below, we will pass a single argument to <code>pd.read_csv()</code>: A string that tells the function where to find the surveys.csv file.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
32.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
1
</th>
<td>
2
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
33.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
2
</th>
<td>
3
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
3
</th>
<td>
4
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
4
</th>
<td>
5
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35544
</th>
<td>
35545
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35545
</th>
<td>
35546
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
35547
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
</tr>
<tr>
<th>
35548
</th>
<td>
35549
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
5
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>
35549 rows × 9 columns
</p>
<p>Here are a few things to observe about how the dataframe is structured:</p>
<ul>
<li>By default, JupyterLab displays the first and last five rows of the dataframe</li>
<li>Each row represents a record</li>
<li>Each column represents a field</li>
<li>The unlabeled column on the far left is called the <em>row label</em>
</li>
<li>pandas has done a lot of work behind the scenes when reading the data, including:
<ul>
<li>Assigning the <em>row index</em> as the row label</li>
<li>Assigning each column a data type based on its contents</li>
<li>Assigning certain cells the value NaN, which stands for “not a number” and is used to designate null values in the dataset. Here, those cells represent blank cells in the spreadsheet.</li>
</ul>
</li>
</ul>
<p>Much of this behavior can be controlled when the spreadsheet is first read by using keyword arguments. For example, to force <code>pd.read_csv()</code> to use the existing record_id column as the row label, use the <em>index_col</em> keyword argument:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pd.read_csv(<span class="st">"data/surveys.csv"</span>, index_col<span class="op">=</span><span class="st">"record_id"</span>)</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr>
<tr>
<th>
record_id
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
<th>
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
1
</th>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
32.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
2
</th>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
33.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
3
</th>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
4
</th>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
5
</th>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35545
</th>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
</tr>
<tr>
<th>
35548
</th>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
</tr>
<tr>
<th>
35549
</th>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
5
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>
35549 rows × 8 columns
</p>
<p>Now record_id appears on the far left, indicating that pandas is using that column as the row label.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<p>Run <code>help()</code> on the <code>pd.read_csv()</code> method (note that you should omit the trailing parentheses). Alternatively, take a look at the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html" class="external-link">much prettier documentation</a> provided by the pandas developers. Based on that information, answer the following questions:</p>
<ol style="list-style-type: decimal">
<li>What parameter would you use to control how null values are interpreted?</li>
<li>What values are interpreted as NaN by default?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution to challenge 1
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>na_values</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution to challenge 2
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>In addition to empty cells, the following values are interpreted as NaN, or null, by pandas. These strings may look familiar from programs like Excel.</p>
<ul>
<li>#N/A</li>
<li>#N/A N/A</li>
<li>#NA</li>
<li>-1.#IND</li>
<li>-1.#QNAN</li>
<li>-NaN</li>
<li>-nan</li>
<li>1.#IND</li>
<li>1.#QNAN</li>
<li>&lt;NA&gt;</li>
<li>N/A</li>
<li>NA</li>
<li>NULL</li>
<li>NaN</li>
<li>n/a</li>
<li>nan</li>
<li>null</li>
</ul>
</div>
</div>
</div>
</div>
</section><section id="assigning-to-variables"><h2 class="section-heading">Assigning to variables<a class="anchor" aria-label="anchor" href="#assigning-to-variables"></a>
</h2>
<hr class="half-width">
<p>We can assign the dataframe to a variable to make it easier to access. As we saw in the previous lesson, we use a single equals sign to assign an object to a variable. The variable name should be short and descriptive. By convention, variable names in Python use snake_case (that is, lower case with individual words separated by underscores).</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>surveys <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>surveys</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
32.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
1
</th>
<td>
2
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
33.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
2
</th>
<td>
3
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
3
</th>
<td>
4
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
4
</th>
<td>
5
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35544
</th>
<td>
35545
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35545
</th>
<td>
35546
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
35547
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
</tr>
<tr>
<th>
35548
</th>
<td>
35549
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
5
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>
35549 rows × 9 columns
</p>
</section><section id="understanding-data-types-in-pandas"><h2 class="section-heading">Understanding data types in pandas<a class="anchor" aria-label="anchor" href="#understanding-data-types-in-pandas"></a>
</h2>
<hr class="half-width">
<p>We can use the <code>info()</code> method to see how pandas interpreted each column in the dataset. This method gives use the name, count, and data type of each column and provides some information about the dataset as a whole (for example, memory usage, which is helpful to know when working with large datasets):</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>surveys.info()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 35549 entries, 0 to 35548
Data columns (total 9 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   record_id        35549 non-null  int64  
 1   month            35549 non-null  int64  
 2   day              35549 non-null  int64  
 3   year             35549 non-null  int64  
 4   plot_id          35549 non-null  int64  
 5   species_id       34786 non-null  object 
 6   sex              33038 non-null  object 
 7   hindfoot_length  31438 non-null  float64
 8   weight           32283 non-null  float64
dtypes: float64(2), int64(5), object(2)
memory usage: 2.4+ MB
</code></pre>
</div>
<p>Note that the data types used by pandas look a little different than the ones used by Python itself. See the table below for the rough equivalents.</p>
<div class="section level3">
<h3 id="data-types-in-pandas">Data types in pandas<a class="anchor" aria-label="anchor" href="#data-types-in-pandas"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th align="left">Data Type</th>
<th align="left">Description</th>
<th align="left">Similar To</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">object</td>
<td align="left">Character string or mixed</td>
<td align="left">str</td>
</tr>
<tr class="even">
<td align="left">int64</td>
<td align="left">Integer numerical</td>
<td align="left">int</td>
</tr>
<tr class="odd">
<td align="left">float64</td>
<td align="left">Approximate numerical</td>
<td align="left">float</td>
</tr>
<tr class="even">
<td align="left">bool</td>
<td align="left">Stores True or False values</td>
<td align="left">bool</td>
</tr>
<tr class="odd">
<td align="left">datetime64</td>
<td align="left">Stores date and time values</td>
<td align="left">datetime.datetime</td>
</tr>
</tbody>
</table>
</div>
</section><section id="saving-a-dataframe"><h2 class="section-heading">Saving a dataframe<a class="anchor" aria-label="anchor" href="#saving-a-dataframe"></a>
</h2>
<hr class="half-width">
<p>When analyzing a dataset, we’ll often want to save our work to a file. The <code>to_csv()</code> method can be used to write a dataframe to a CSV. As when we read a CSV from a file above, we need to provide a path to which to save the file. The example below also includes the <em>index</em> keyword argument. Setting that parameter to False tells pandas not to include the row label when writing the CSV.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>surveys.to_csv(<span class="st">"data/surveys_mod.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<p>This is far from the only option for writing data–pandas supports a variety of file types for both reading and writing. Try searching for “read_” in the <a href="https://pandas.pydata.org/docs/reference/index.html" class="external-link">pandas API reference</a> to see the supported formats.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<ul>
<li>This lesson uses real data from a decades-long survey of rodents in Arizona</li>
<li>pandas is a data analysis library that allows users to read, manipulate, and view tabular data using Python</li>
<li>pandas represents data as a dataframe consisting of rows (records) and columns (fields or variables)</li>
<li>Read a dataframe from CSV using the <code>pd.read_csv()</code> function</li>
<li>Write a dataframe to CSV using the <code>to_csv()</code> method</li>
<li>The behavior of a function can be modified by including arguments and keyword arguments when the function is called</li>
<li>pandas uses its own classes to represent text, numbers, booleans, and datetimes</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-03-accessing-data-in-a-dataframe"><p>Content from <a href="03-accessing-data-in-a-dataframe.html">Accessing Data in a Dataframe</a></p>
<hr>
<p> Last updated on 2022-07-18 | <a href="https://github.com/adamancer/python-ecology-lesson-alt/edit/main/episodes/03-accessing-data-in-a-dataframe.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 60 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can we look at individual rows and columns in a dataframe?</li>
<li>How can we perform calculations?</li>
<li>How can we modify the table and data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Access individual rows and columns</li>
<li>Access multiple columns at once using a list</li>
<li>Perform calculations like addition and subtraction</li>
<li>Rename columns using a dictionary</li>
<li>Access rows containing specific data</li>
<li>Sort the data returned by a query</li>
<li>Modify data using loc</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We’ll begin by importing pandas and reading our CSV, as we did in the previous lesson:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>surveys <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>surveys</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
32.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
1
</th>
<td>
2
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
33.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
2
</th>
<td>
3
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
3
</th>
<td>
4
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
4
</th>
<td>
5
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35544
</th>
<td>
35545
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35545
</th>
<td>
35546
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
35547
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
</tr>
<tr>
<th>
35548
</th>
<td>
35549
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
5
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>
35549 rows × 9 columns
</p>
<p>We will now look at how to access rows and columns in the dataframe.</p>
<section id="getting-columns"><h2 class="section-heading">Getting columns<a class="anchor" aria-label="anchor" href="#getting-columns"></a>
</h2>
<hr class="half-width">
<p>We can get the values from a single column by passing a string inside square brackets to the dataframe object. For example, to look at the year column, use:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>surveys[<span class="st">"year"</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0        1977
1        1977
2        1977
3        1977
4        1977
         ...
35544    2002
35545    2002
35546    2002
35547    2002
35548    2002
Name: year, Length: 35549, dtype: int64</code></pre>
</div>
<p>A single column is returned as a <code>Series</code>, which is why the output for this cell is formatted differently than the other cells in this lesson. The main difference between a <code>Series</code> and a <code>DataFrame</code> is that a <code>DataFrame</code> can have multiple columns. The two classes share many but not all attributes and methods. Note also that this is a copy of data from the original dataframe. Changing values in the series will have no effect on the original dataframe.</p>
<div class="section level3">
<h3 id="using-lists-to-get-more-than-one-column-at-a-time">Using lists to get more than one column at a time<a class="anchor" aria-label="anchor" href="#using-lists-to-get-more-than-one-column-at-a-time"></a>
</h3>
<p>Python uses the built-in <code>list</code> data type to store sequences, that is, an ordered list of objects. Any type of Python object can be stored in a list: strings, integers, floats, even other lists or collections. Once created, a list can be modified by appending, inserting, or deleting items. We will not be going into detail about these operations here, but as always you can learn more about how to use a list using <code>help()</code> or <a href="https://docs.python.org/3/library/stdtypes.html#list" class="external-link">the Python docs</a>.</p>
<p>Create a list using square brackets. Let’s create a list of the three columns in our dataframe that together give the date of an observation:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> [<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>]</span></code></pre>
</div>
<p>When we pass this list to the survey dataframe using square brackets, as we did above, we retrieve a copy of the dataframe containing just those columns. Note that, when we get more than one column, pandas returns a dataframe:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>surveys[cols]</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
year
</th>
<th>
month
</th>
<th>
day
</th>
</tr></thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1977
</td>
<td>
7
</td>
<td>
16
</td>
</tr>
<tr>
<th>
1
</th>
<td>
1977
</td>
<td>
7
</td>
<td>
16
</td>
</tr>
<tr>
<th>
2
</th>
<td>
1977
</td>
<td>
7
</td>
<td>
16
</td>
</tr>
<tr>
<th>
3
</th>
<td>
1977
</td>
<td>
7
</td>
<td>
16
</td>
</tr>
<tr>
<th>
4
</th>
<td>
1977
</td>
<td>
7
</td>
<td>
16
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35544
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
</tr>
<tr>
<th>
35545
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
</tr>
<tr>
<th>
35548
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
</tr>
</tbody>
</table>
<p>
35549 rows × 3 columns
</p>
</div>
</section><section id="getting-rows"><h2 class="section-heading">Getting rows<a class="anchor" aria-label="anchor" href="#getting-rows"></a>
</h2>
<hr class="half-width">
<p>We can get the rows at the beginning of the table using the head method:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>surveys.head()</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
32.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
1
</th>
<td>
2
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
33.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
2
</th>
<td>
3
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
3
</th>
<td>
4
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
4
</th>
<td>
5
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>By default, this methods returns the first five rows. We can provide a number inside the parentheses if we need a specific number of rows:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>surveys.head(<span class="dv">20</span>)</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
32.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
1
</th>
<td>
2
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
33.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
2
</th>
<td>
3
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
3
</th>
<td>
4
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
4
</th>
<td>
5
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
5
</th>
<td>
6
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
1
</td>
<td>
PF
</td>
<td>
M
</td>
<td>
14.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
6
</th>
<td>
7
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
PE
</td>
<td>
F
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
7
</th>
<td>
8
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
1
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
8
</th>
<td>
9
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
1
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
34.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
9
</th>
<td>
10
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
6
</td>
<td>
PF
</td>
<td>
F
</td>
<td>
20.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
10
</th>
<td>
11
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
5
</td>
<td>
DS
</td>
<td>
F
</td>
<td>
53.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
11
</th>
<td>
12
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
38.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
12
</th>
<td>
13
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
13
</th>
<td>
14
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
8
</td>
<td>
DM
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
14
</th>
<td>
15
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
6
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
15
</th>
<td>
16
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
4
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
16
</th>
<td>
17
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DS
</td>
<td>
F
</td>
<td>
48.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
17
</th>
<td>
18
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
PP
</td>
<td>
M
</td>
<td>
22.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
18
</th>
<td>
19
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
4
</td>
<td>
PF
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
19
</th>
<td>
20
</td>
<td>
7
</td>
<td>
17
</td>
<td>
1977
</td>
<td>
11
</td>
<td>
DS
</td>
<td>
F
</td>
<td>
48.0
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>The <code>tail()</code> method is similar, except it returns rows from the end of the table:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>surveys.tail()</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
35544
</th>
<td>
35545
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35545
</th>
<td>
35546
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
35547
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
</tr>
<tr>
<th>
35548
</th>
<td>
35549
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
5
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>The <code>head()</code> and <code>tail()</code> methods are useful for getting a feel for how our data is structured, but we’ll also want to be able to look at specific rows. As when we selected columns above, we can use square brackets to extract <em>slices</em> from the dataframe. A slice is a subset of the dataframe starting at one row and ending at another. To get a slice, we pass the starting and ending indexes to the square brackets as <code>start:end</code>:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>surveys[<span class="dv">2</span>:<span class="dv">5</span>]</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
2
</th>
<td>
3
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
3
</th>
<td>
4
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
4
</th>
<td>
5
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>There are three things to be aware of when slicing a dataframe:</p>
<ul>
<li>Row indexes are zero-based. That is, the first row has an index of 0, not 1.</li>
<li>When slicing, the slice includes start but not the end index. In this case, that means the slice includes rows 2, 3, and 4 but not 5.</li>
<li>The row label can be different from the row index. They happen to be the same here, but don’t count on that being true.</li>
</ul>
<p>Core Python types like <code>list</code> and <code>tuple</code> use the same conventions, as do most libraries that deal with sequences.</p>
</section><section id="getting-unique-values"><h2 class="section-heading">Getting unique values<a class="anchor" aria-label="anchor" href="#getting-unique-values"></a>
</h2>
<hr class="half-width">
<p>Recall that we can use square brackets to return a single column from a dataframe. We can get the list of unique values within that column using the <code>unique()</code> method:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>surveys[<span class="st">"species_id"</span>].unique()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>array(['NL', 'DM', 'PF', 'PE', 'DS', 'PP', 'SH', 'OT', 'DO', 'OX', 'SS',
       'OL', 'RM', nan, 'SA', 'PM', 'AH', 'DX', 'AB', 'CB', 'CM', 'CQ',
       'RF', 'PC', 'PG', 'PH', 'PU', 'CV', 'UR', 'UP', 'ZL', 'UL', 'CS',
       'SC', 'BA', 'SF', 'RO', 'AS', 'SO', 'PI', 'ST', 'CU', 'SU', 'RX',
       'PB', 'PL', 'PX', 'CT', 'US'], dtype=object)</code></pre>
</div>
<p>To do the same across multiple columns, we can use the <code>drop_duplicates()</code> method on a copy of the dataframe containing only the columns we’re interested in. Like any well-named method, <code>drop_duplicates()</code> does exactly what the name implies: It returns a copy of the dataframe with all duplicate rows removed.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>surveys[[<span class="st">"plot_id"</span>, <span class="st">"species_id"</span>]].drop_duplicates()</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
</tr></thead>
<tbody>
<tr>
<th>
0
</th>
<td>
2
</td>
<td>
NL
</td>
</tr>
<tr>
<th>
1
</th>
<td>
3
</td>
<td>
NL
</td>
</tr>
<tr>
<th>
2
</th>
<td>
2
</td>
<td>
DM
</td>
</tr>
<tr>
<th>
3
</th>
<td>
7
</td>
<td>
DM
</td>
</tr>
<tr>
<th>
4
</th>
<td>
3
</td>
<td>
DM
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35474
</th>
<td>
22
</td>
<td>
SF
</td>
</tr>
<tr>
<th>
35511
</th>
<td>
11
</td>
<td>
US
</td>
</tr>
<tr>
<th>
35519
</th>
<td>
9
</td>
<td>
SF
</td>
</tr>
<tr>
<th>
35527
</th>
<td>
13
</td>
<td>
US
</td>
</tr>
<tr>
<th>
35543
</th>
<td>
15
</td>
<td>
US
</td>
</tr>
</tbody>
</table>
<p>
612 rows × 2 columns
</p>
</section><section id="calculating-values"><h2 class="section-heading">Calculating values<a class="anchor" aria-label="anchor" href="#calculating-values"></a>
</h2>
<hr class="half-width">
<p>The survey dataset includes two columns, hindfoot_length and weight, that are stored as numbers and represent measurements. We may want to perform calculations using numbers like these in our own data. We can do so using Python’s built-in mathematical operators, including:</p>
<ul>
<li>
<code>x + y</code> for addition</li>
<li>
<code>x - y</code> for subtraction</li>
<li>
<code>x * y</code> for multiplication</li>
<li>
<code>x / y</code> for division</li>
<li>
<code>x % y</code> for calculating remainders</li>
<li>
<code>x ** y</code> for exponents</li>
</ul>
<p>To make the examples in this section a little more useful, we’re going to remove all rows that contain null values using the <code>dropna()</code> method. This will filter out any rows that don’t have a valid hindfoot_length or weight, as well as those that have a null value in any other cell. (This is an inelegant solution to the problem of missing data. We’ll talk about more nuanced solutions later in the lesson.)</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>surveys_nona <span class="op">=</span> surveys.dropna().copy()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>surveys_nona</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
62
</th>
<td>
63
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
40.0
</td>
</tr>
<tr>
<th>
63
</th>
<td>
64
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
48.0
</td>
</tr>
<tr>
<th>
64
</th>
<td>
65
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
4
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
34.0
</td>
<td>
29.0
</td>
</tr>
<tr>
<th>
65
</th>
<td>
66
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
4
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
35.0
</td>
<td>
46.0
</td>
</tr>
<tr>
<th>
66
</th>
<td>
67
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
36.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35540
</th>
<td>
35541
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
24.0
</td>
<td>
31.0
</td>
</tr>
<tr>
<th>
35541
</th>
<td>
35542
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
26.0
</td>
<td>
29.0
</td>
</tr>
<tr>
<th>
35542
</th>
<td>
35543
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
27.0
</td>
<td>
34.0
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
35547
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
</tr>
</tbody>
</table>
<p>
30676 rows × 9 columns
</p>
<p>Suppose we want to convert the weight column from grams to milligrams. To do so, we can multiply that column by 1000:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>surveys_nona[<span class="st">"weight"</span>] <span class="op">*</span> <span class="dv">1000</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>62       40000.0
63       48000.0
64       29000.0
65       46000.0
66       36000.0
          ...   
35540    31000.0
35541    29000.0
35542    34000.0
35546    14000.0
35547    51000.0
Name: weight, Length: 30676, dtype: float64</code></pre>
</div>
<p>To convert it to kilograms, we can divide by 1000:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>surveys_nona[<span class="st">"weight"</span>] <span class="op">/</span> <span class="dv">1000</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>62       0.040
63       0.048
64       0.029
65       0.046
66       0.036
         ...  
35540    0.031
35541    0.029
35542    0.034
35546    0.014
35547    0.051
Name: weight, Length: 30676, dtype: float64</code></pre>
</div>
<p>Note that calculations do not modify the original dataset. If we want to retain the result, we have to assign it to a new column:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>surveys_nona[<span class="st">"weight_mg"</span>] <span class="op">=</span> surveys_nona[<span class="st">"weight"</span>] <span class="op">*</span> <span class="dv">1000</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>surveys_nona</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
<th>
weight_mg
</th>
</tr></thead>
<tbody>
<tr>
<th>
62
</th>
<td>
63
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
40.0
</td>
<td>
40000.0
</td>
</tr>
<tr>
<th>
63
</th>
<td>
64
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
48.0
</td>
<td>
48000.0
</td>
</tr>
<tr>
<th>
64
</th>
<td>
65
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
4
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
34.0
</td>
<td>
29.0
</td>
<td>
29000.0
</td>
</tr>
<tr>
<th>
65
</th>
<td>
66
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
4
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
35.0
</td>
<td>
46.0
</td>
<td>
46000.0
</td>
</tr>
<tr>
<th>
66
</th>
<td>
67
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
36.0
</td>
<td>
36000.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35540
</th>
<td>
35541
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
24.0
</td>
<td>
31.0
</td>
<td>
31000.0
</td>
</tr>
<tr>
<th>
35541
</th>
<td>
35542
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
26.0
</td>
<td>
29.0
</td>
<td>
29000.0
</td>
</tr>
<tr>
<th>
35542
</th>
<td>
35543
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
27.0
</td>
<td>
34.0
</td>
<td>
34000.0
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
35547
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
<td>
14000.0
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
<td>
51000.0
</td>
</tr>
</tbody>
</table>
<p>
30676 rows × 10 columns
</p>
<p>We can also add, subtract, multiply, and divide columns, as in the following (admittedly nonsensical) calculation, which adds together the hindfoot_length and weight columns:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>surveys_nona[<span class="st">"hindfoot_length"</span>] <span class="op">+</span> surveys_nona[<span class="st">"weight"</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>62       75.0
63       85.0
64       63.0
65       81.0
66       71.0
         ...
35540    55.0
35541    55.0
35542    61.0
35546    29.0
35547    87.0
Length: 30676, dtype: float64</code></pre>
</div>
</section><section id="renaming-columns"><h2 class="section-heading">Renaming columns<a class="anchor" aria-label="anchor" href="#renaming-columns"></a>
</h2>
<hr class="half-width">
<p>The hindfoot_length and weight columns don’t specify a unit, which may get confusing if we want to perform unit conversions like the one above. Fortunately, dataframes allow us to rename existing columns using the <code>rename()</code> method.</p>
<p>The <code>rename()</code> method uses a dictionary (or <code>dict</code>) to map between the old and new column names. As with <code>list</code> above, the <code>dict</code> data type is built into Python–we don’t need to import anything to use it. A <code>dict</code> maps keys to values. We can create one using curly braces:</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dct <span class="op">=</span> {<span class="st">"key1"</span>: <span class="st">"val1"</span>, <span class="st">"key2"</span>: <span class="st">"val2"</span>}</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>dct</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{'key1': 'val1', 'key2': 'val2'}</code></pre>
</div>
<p>Dictionaries are a useful and highly flexible data type. As with <code>list</code> above, we’ll be giving them short shrift here, but you can learn more about them at <a href="https://docs.python.org/3/library/stdtypes.html#dict" class="external-link">the Python docs</a>.</p>
<p>Here we’ll use a <code>dict</code> to specify how we want to rename our columns. The <em>keys</em> will be the current column names and the <em>values</em> the new column names. Note that we explicitly assign the result of <code>rename()</code> to the original variable–by default, <code>rename()</code> returns a copy of the original dataframe instead of modifying the original dataframe.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dict that maps from the old to the new column name</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cols <span class="op">=</span> {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"hindfoot_length"</span>: <span class="st">"hindfoot_length_mm"</span>,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"weight"</span>: <span class="st">"weight_g"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign the result of the rename method back to surveys_nona</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>surveys_nona <span class="op">=</span> surveys_nona.rename(columns<span class="op">=</span>cols)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View the dataframe with the new column names</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>surveys_nona</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length_mm
</th>
<th>
weight_g
</th>
<th>
weight_mg
</th>
</tr></thead>
<tbody>
<tr>
<th>
62
</th>
<td>
63
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
40.0
</td>
<td>
40000.0
</td>
</tr>
<tr>
<th>
63
</th>
<td>
64
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
48.0
</td>
<td>
48000.0
</td>
</tr>
<tr>
<th>
64
</th>
<td>
65
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
4
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
34.0
</td>
<td>
29.0
</td>
<td>
29000.0
</td>
</tr>
<tr>
<th>
65
</th>
<td>
66
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
4
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
35.0
</td>
<td>
46.0
</td>
<td>
46000.0
</td>
</tr>
<tr>
<th>
66
</th>
<td>
67
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
36.0
</td>
<td>
36000.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35540
</th>
<td>
35541
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
24.0
</td>
<td>
31.0
</td>
<td>
31000.0
</td>
</tr>
<tr>
<th>
35541
</th>
<td>
35542
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
26.0
</td>
<td>
29.0
</td>
<td>
29000.0
</td>
</tr>
<tr>
<th>
35542
</th>
<td>
35543
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
27.0
</td>
<td>
34.0
</td>
<td>
34000.0
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
35547
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
<td>
14000.0
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
<td>
51000.0
</td>
</tr>
</tbody>
</table>
<p>
30676 rows × 10 columns
</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<p>Create a dataframe that returns the year, month, day, species_id and weight in mg.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign the weight in milligrams to the weight_mg column</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>surveys_nona[<span class="st">"weight_mg"</span>] <span class="op">=</span> surveys_nona[<span class="st">"weight_g"</span>] <span class="op">*</span> <span class="dv">1000</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display a copy of survey with only the desired columns</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>surveys_nona[[<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>, <span class="st">"species_id"</span>, <span class="st">"weight_mg"</span>]]</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
year
</th>
<th>
month
</th>
<th>
day
</th>
<th>
species_id
</th>
<th>
weight_mg
</th>
</tr></thead>
<tbody>
<tr>
<th>
62
</th>
<td>
1977
</td>
<td>
8
</td>
<td>
19
</td>
<td>
DM
</td>
<td>
40000.0
</td>
</tr>
<tr>
<th>
63
</th>
<td>
1977
</td>
<td>
8
</td>
<td>
19
</td>
<td>
DM
</td>
<td>
48000.0
</td>
</tr>
<tr>
<th>
64
</th>
<td>
1977
</td>
<td>
8
</td>
<td>
19
</td>
<td>
DM
</td>
<td>
29000.0
</td>
</tr>
<tr>
<th>
65
</th>
<td>
1977
</td>
<td>
8
</td>
<td>
19
</td>
<td>
DM
</td>
<td>
46000.0
</td>
</tr>
<tr>
<th>
66
</th>
<td>
1977
</td>
<td>
8
</td>
<td>
19
</td>
<td>
DM
</td>
<td>
36000.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35540
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
<td>
PB
</td>
<td>
31000.0
</td>
</tr>
<tr>
<th>
35541
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
<td>
PB
</td>
<td>
29000.0
</td>
</tr>
<tr>
<th>
35542
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
<td>
PB
</td>
<td>
34000.0
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
<td>
RM
</td>
<td>
14000.0
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
<td>
DO
</td>
<td>
51000.0
</td>
</tr>
</tbody>
</table>
<p>
30676 rows × 5 columns
</p>
</div>
</div>
</div>
</div>
</section><section id="filtering-data"><h2 class="section-heading">Filtering data<a class="anchor" aria-label="anchor" href="#filtering-data"></a>
</h2>
<hr class="half-width">
<p>pandas provides a variety of ways to filter a dataframe. For example, suppose we want to look at a specific species in the surveys_nona dataframe. We can view the rows matching a given species using the same square brackets we used above to select specific columns and rows. Here, however, instead of passing a value or list of values, we will pass a <em>conditional expression</em>.</p>
<p>A conditional expression is a statement that evaluates as either True or False. They often make use of inequality operators, for example:</p>
<ul>
<li>
<code>==</code> for equals</li>
<li>
<code>!=</code> for does not equal</li>
<li>
<code>&gt;</code> for greater than</li>
<li>
<code>&gt;=</code> for greater than or equal to</li>
<li>
<code>&lt;</code> for less than</li>
<li>
<code>&lt;=</code> for less than or equal to</li>
</ul>
<p>Examples of conditional statements include:</p>
<ul>
<li>
<code>"a" == "b"</code> evaluates False</li>
<li>
<code>"a" != b"</code> evaluates True</li>
<li>
<code>3 &gt; 4</code> evaluates False</li>
</ul>
<p>Note that, when comparing strings, evaluations are case sensitive:</p>
<ul>
<li>
<code>"a" == "A"</code> evaluates False</li>
</ul>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="for-assignment-for-equality" class="callout-inner">
<h3 class="callout-title">= for assignment, == for equality<a class="anchor" aria-label="anchor" href="#for-assignment-for-equality"></a>
</h3>
<div class="callout-content">
<p>Remember that, in Python, a single equal sign is used to assign values to variables. We’ve already used the assignment operator in this lesson, for example, when we created a new column in the dataframe.</p>
</div>
</div>
</div>
<p>To limit the dataframe to rows matching the species “DM”, include the conditional <code>surveys_nona["species_id"] == "DM"</code> inside the square brackets:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>surveys_nona[surveys_nona[<span class="st">"species_id"</span>] <span class="op">==</span> <span class="st">"DM"</span>]</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length_mm
</th>
<th>
weight_g
</th>
<th>
weight_mg
</th>
</tr></thead>
<tbody>
<tr>
<th>
62
</th>
<td>
63
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
40.0
</td>
<td>
40000.0
</td>
</tr>
<tr>
<th>
63
</th>
<td>
64
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
48.0
</td>
<td>
48000.0
</td>
</tr>
<tr>
<th>
64
</th>
<td>
65
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
4
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
34.0
</td>
<td>
29.0
</td>
<td>
29000.0
</td>
</tr>
<tr>
<th>
65
</th>
<td>
66
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
4
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
35.0
</td>
<td>
46.0
</td>
<td>
46000.0
</td>
</tr>
<tr>
<th>
66
</th>
<td>
67
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
36.0
</td>
<td>
36000.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35532
</th>
<td>
35533
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
48.0
</td>
<td>
48000.0
</td>
</tr>
<tr>
<th>
35533
</th>
<td>
35534
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
56.0
</td>
<td>
56000.0
</td>
</tr>
<tr>
<th>
35534
</th>
<td>
35535
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
53.0
</td>
<td>
53000.0
</td>
</tr>
<tr>
<th>
35535
</th>
<td>
35536
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
35.0
</td>
<td>
42.0
</td>
<td>
42000.0
</td>
</tr>
<tr>
<th>
35536
</th>
<td>
35537
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
46.0
</td>
<td>
46000.0
</td>
</tr>
</tbody>
</table>
<p>
9727 rows × 10 columns
</p>
<p>To limit our results to observations made in or after 2000, use:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>surveys_nona[surveys_nona[<span class="st">"year"</span>] <span class="op">&gt;=</span> <span class="dv">2000</span>]</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length_mm
</th>
<th>
weight_g
</th>
<th>
weight_mg
</th>
</tr></thead>
<tbody>
<tr>
<th>
30158
</th>
<td>
30159
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
1
</td>
<td>
PP
</td>
<td>
F
</td>
<td>
22.0
</td>
<td>
17.0
</td>
<td>
17000.0
</td>
</tr>
<tr>
<th>
30159
</th>
<td>
30160
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
53.0
</td>
<td>
53000.0
</td>
</tr>
<tr>
<th>
30160
</th>
<td>
30161
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
1
</td>
<td>
PP
</td>
<td>
F
</td>
<td>
21.0
</td>
<td>
17.0
</td>
<td>
17000.0
</td>
</tr>
<tr>
<th>
30161
</th>
<td>
30162
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
1
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
50.0
</td>
<td>
50000.0
</td>
</tr>
<tr>
<th>
30162
</th>
<td>
30163
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
1
</td>
<td>
PP
</td>
<td>
M
</td>
<td>
20.0
</td>
<td>
16.0
</td>
<td>
16000.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35540
</th>
<td>
35541
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
24.0
</td>
<td>
31.0
</td>
<td>
31000.0
</td>
</tr>
<tr>
<th>
35541
</th>
<td>
35542
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
26.0
</td>
<td>
29.0
</td>
<td>
29000.0
</td>
</tr>
<tr>
<th>
35542
</th>
<td>
35543
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
27.0
</td>
<td>
34.0
</td>
<td>
34000.0
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
35547
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
<td>
14000.0
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
<td>
51000.0
</td>
</tr>
</tbody>
</table>
<p>
4947 rows × 10 columns
</p>
<p>As with <code>rename()</code> above, each filtering operation returns a copy of the dataframe. We will look at how to make changes to the original dataframe at the end of this lesson.</p>
</section><section id="building-more-complex-queries"><h2 class="section-heading">Building more complex queries<a class="anchor" aria-label="anchor" href="#building-more-complex-queries"></a>
</h2>
<hr class="half-width">
<p>We can combine conditionals using what are called <em>bitwise operators</em>:</p>
<ul>
<li>
<code>&amp;</code>: True if conditions on both sides of the operator are True (and)</li>
<li>
<code>|</code>: True if a condition on either side is True (or)</li>
</ul>
<p>To return all observations of DM in or after 2000, we can combine the two conditionals we used previously. Note that, when joining conditionals using <code>&amp;</code> or <code>|</code>, we must wrap each individual condition in parentheses. If we omit the parentheses, pandas will not perform the comparisons in the expected order.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>surveys_nona[(surveys_nona[<span class="st">"species_id"</span>] <span class="op">==</span> <span class="st">"DM"</span>) <span class="op">&amp;</span> (surveys_nona[<span class="st">"year"</span>] <span class="op">&gt;=</span> <span class="dv">2000</span>)]</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length_mm
</th>
<th>
weight_g
</th>
<th>
weight_mg
</th>
</tr></thead>
<tbody>
<tr>
<th>
30161
</th>
<td>
30162
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
1
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
50.0
</td>
<td>
50000.0
</td>
</tr>
<tr>
<th>
30178
</th>
<td>
30179
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
12
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
60.0
</td>
<td>
60000.0
</td>
</tr>
<tr>
<th>
30195
</th>
<td>
30196
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
17
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
52.0
</td>
<td>
52000.0
</td>
</tr>
<tr>
<th>
30196
</th>
<td>
30197
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
17
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
34.0
</td>
<td>
43.0
</td>
<td>
43000.0
</td>
</tr>
<tr>
<th>
30209
</th>
<td>
30210
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
22
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
38.0
</td>
<td>
56.0
</td>
<td>
56000.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35532
</th>
<td>
35533
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
48.0
</td>
<td>
48000.0
</td>
</tr>
<tr>
<th>
35533
</th>
<td>
35534
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
56.0
</td>
<td>
56000.0
</td>
</tr>
<tr>
<th>
35534
</th>
<td>
35535
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
53.0
</td>
<td>
53000.0
</td>
</tr>
<tr>
<th>
35535
</th>
<td>
35536
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
35.0
</td>
<td>
42.0
</td>
<td>
42000.0
</td>
</tr>
<tr>
<th>
35536
</th>
<td>
35537
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
46.0
</td>
<td>
46000.0
</td>
</tr>
</tbody>
</table>
<p>
823 rows × 10 columns
</p>
<p>Some column methods can also be used for filtering. One example is <code>isin()</code>, which is used to match a list of values. This method can be combined with other conditionals as above. The example below returns rows from 2000 or later with either “DM”, “DO”, or “DS” in the species_id column:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>surveys_nona[</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    surveys_nona[<span class="st">"species_id"</span>].isin([<span class="st">"DM"</span>, <span class="st">"DO"</span>, <span class="st">"DS"</span>]) <span class="op">&amp;</span> (surveys_nona[<span class="st">"year"</span>] <span class="op">&gt;=</span> <span class="dv">2000</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>]</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length_mm
</th>
<th>
weight_g
</th>
<th>
weight_mg
</th>
</tr></thead>
<tbody>
<tr>
<th>
30159
</th>
<td>
30160
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
53.0
</td>
<td>
53000.0
</td>
</tr>
<tr>
<th>
30161
</th>
<td>
30162
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
1
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
50.0
</td>
<td>
50000.0
</td>
</tr>
<tr>
<th>
30166
</th>
<td>
30167
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
41.0
</td>
<td>
41000.0
</td>
</tr>
<tr>
<th>
30170
</th>
<td>
30171
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
2
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
52.0
</td>
<td>
52000.0
</td>
</tr>
<tr>
<th>
30172
</th>
<td>
30173
</td>
<td>
1
</td>
<td>
8
</td>
<td>
2000
</td>
<td>
2
</td>
<td>
DO
</td>
<td>
F
</td>
<td>
35.0
</td>
<td>
54.0
</td>
<td>
54000.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35533
</th>
<td>
35534
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
56.0
</td>
<td>
56000.0
</td>
</tr>
<tr>
<th>
35534
</th>
<td>
35535
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
53.0
</td>
<td>
53000.0
</td>
</tr>
<tr>
<th>
35535
</th>
<td>
35536
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
35.0
</td>
<td>
42.0
</td>
<td>
42000.0
</td>
</tr>
<tr>
<th>
35536
</th>
<td>
35537
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
46.0
</td>
<td>
46000.0
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
<td>
51000.0
</td>
</tr>
</tbody>
</table>
<p>
1229 rows × 10 columns
</p>
</section><section id="sorting-data"><h2 class="section-heading">Sorting data<a class="anchor" aria-label="anchor" href="#sorting-data"></a>
</h2>
<hr class="half-width">
<p>We can sort a dataframe using the <code>sort_values()</code> method. For this example, we’ll work from the subset defined above. First we need to assign that subset to a variable:</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> surveys_nona[</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    surveys_nona[<span class="st">"species_id"</span>].isin([<span class="st">"DM"</span>, <span class="st">"DO"</span>, <span class="st">"DS"</span>]) <span class="op">&amp;</span> (surveys_nona[<span class="st">"year"</span>] <span class="op">&gt;=</span> <span class="dv">2000</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>]</span></code></pre>
</div>
<p>Now we’ll sort the results by weight_g. To do so, pass that column name as an argument (that is, inside the trailing parentheses) to the <code>sort_values()</code> method:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>results.sort_values(<span class="st">"weight_g"</span>)</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length_mm
</th>
<th>
weight_g
</th>
<th>
weight_mg
</th>
</tr></thead>
<tbody>
<tr>
<th>
30614
</th>
<td>
30615
</td>
<td>
4
</td>
<td>
30
</td>
<td>
2000
</td>
<td>
12
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
34.0
</td>
<td>
18.0
</td>
<td>
18000.0
</td>
</tr>
<tr>
<th>
34790
</th>
<td>
34791
</td>
<td>
10
</td>
<td>
5
</td>
<td>
2002
</td>
<td>
17
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
34.0
</td>
<td>
20.0
</td>
<td>
20000.0
</td>
</tr>
<tr>
<th>
32650
</th>
<td>
32651
</td>
<td>
9
</td>
<td>
22
</td>
<td>
2001
</td>
<td>
17
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
33.0
</td>
<td>
21.0
</td>
<td>
21000.0
</td>
</tr>
<tr>
<th>
32782
</th>
<td>
32783
</td>
<td>
9
</td>
<td>
23
</td>
<td>
2001
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
34.0
</td>
<td>
21.0
</td>
<td>
21000.0
</td>
</tr>
<tr>
<th>
32968
</th>
<td>
32969
</td>
<td>
10
</td>
<td>
14
</td>
<td>
2001
</td>
<td>
9
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
32.0
</td>
<td>
22.0
</td>
<td>
22000.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35159
</th>
<td>
35160
</td>
<td>
11
</td>
<td>
10
</td>
<td>
2002
</td>
<td>
13
</td>
<td>
DO
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
65.0
</td>
<td>
65000.0
</td>
</tr>
<tr>
<th>
30289
</th>
<td>
30290
</td>
<td>
2
</td>
<td>
5
</td>
<td>
2000
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
65.0
</td>
<td>
65000.0
</td>
</tr>
<tr>
<th>
31942
</th>
<td>
31943
</td>
<td>
4
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
68.0
</td>
<td>
68000.0
</td>
</tr>
<tr>
<th>
32041
</th>
<td>
32042
</td>
<td>
5
</td>
<td>
26
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
68.0
</td>
<td>
68000.0
</td>
</tr>
<tr>
<th>
31955
</th>
<td>
31956
</td>
<td>
4
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
24
</td>
<td>
DO
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
76.0
</td>
<td>
76000.0
</td>
</tr>
</tbody>
</table>
<p>
1229 rows × 10 columns
</p>
<p>By default, rows are sorted in ascending order (smallest to largest). We can modify this behavior using the <em>ascending</em> keyword argument:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>results.sort_values(<span class="st">"weight_g"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length_mm
</th>
<th>
weight_g
</th>
<th>
weight_mg
</th>
</tr></thead>
<tbody>
<tr>
<th>
31955
</th>
<td>
31956
</td>
<td>
4
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
24
</td>
<td>
DO
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
76.0
</td>
<td>
76000.0
</td>
</tr>
<tr>
<th>
32041
</th>
<td>
32042
</td>
<td>
5
</td>
<td>
26
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
68.0
</td>
<td>
68000.0
</td>
</tr>
<tr>
<th>
31942
</th>
<td>
31943
</td>
<td>
4
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
68.0
</td>
<td>
68000.0
</td>
</tr>
<tr>
<th>
35159
</th>
<td>
35160
</td>
<td>
11
</td>
<td>
10
</td>
<td>
2002
</td>
<td>
13
</td>
<td>
DO
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
65.0
</td>
<td>
65000.0
</td>
</tr>
<tr>
<th>
30289
</th>
<td>
30290
</td>
<td>
2
</td>
<td>
5
</td>
<td>
2000
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
65.0
</td>
<td>
65000.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
32957
</th>
<td>
32958
</td>
<td>
10
</td>
<td>
14
</td>
<td>
2001
</td>
<td>
9
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
33.0
</td>
<td>
22.0
</td>
<td>
22000.0
</td>
</tr>
<tr>
<th>
32650
</th>
<td>
32651
</td>
<td>
9
</td>
<td>
22
</td>
<td>
2001
</td>
<td>
17
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
33.0
</td>
<td>
21.0
</td>
<td>
21000.0
</td>
</tr>
<tr>
<th>
32782
</th>
<td>
32783
</td>
<td>
9
</td>
<td>
23
</td>
<td>
2001
</td>
<td>
14
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
34.0
</td>
<td>
21.0
</td>
<td>
21000.0
</td>
</tr>
<tr>
<th>
34790
</th>
<td>
34791
</td>
<td>
10
</td>
<td>
5
</td>
<td>
2002
</td>
<td>
17
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
34.0
</td>
<td>
20.0
</td>
<td>
20000.0
</td>
</tr>
<tr>
<th>
30614
</th>
<td>
30615
</td>
<td>
4
</td>
<td>
30
</td>
<td>
2000
</td>
<td>
12
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
34.0
</td>
<td>
18.0
</td>
<td>
18000.0
</td>
</tr>
</tbody>
</table>
<p>
1229 rows × 10 columns
</p>
<p>We can sort on multiple fields at once by passing a list of column names. We can control how each column sorts by passing a list with the same number of values (that is, one value per column) to the ascending keyword. The cell below sorts the results first by species_id (largest to smallest), then by weight (smallest to largest):</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>results.sort_values([<span class="st">"species_id"</span>, <span class="st">"weight_g"</span>], ascending<span class="op">=</span>[<span class="va">False</span>, <span class="va">True</span>])</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length_mm
</th>
<th>
weight_g
</th>
<th>
weight_mg
</th>
</tr></thead>
<tbody>
<tr>
<th>
30687
</th>
<td>
30688
</td>
<td>
5
</td>
<td>
1
</td>
<td>
2000
</td>
<td>
8
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
23.0
</td>
<td>
23000.0
</td>
</tr>
<tr>
<th>
30768
</th>
<td>
30769
</td>
<td>
6
</td>
<td>
3
</td>
<td>
2000
</td>
<td>
17
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
24.0
</td>
<td>
24000.0
</td>
</tr>
<tr>
<th>
33339
</th>
<td>
33340
</td>
<td>
1
</td>
<td>
12
</td>
<td>
2002
</td>
<td>
12
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
34.0
</td>
<td>
24.0
</td>
<td>
24000.0
</td>
</tr>
<tr>
<th>
34082
</th>
<td>
34083
</td>
<td>
5
</td>
<td>
16
</td>
<td>
2002
</td>
<td>
6
</td>
<td>
DO
</td>
<td>
F
</td>
<td>
33.0
</td>
<td>
24.0
</td>
<td>
24000.0
</td>
</tr>
<tr>
<th>
34096
</th>
<td>
34097
</td>
<td>
5
</td>
<td>
16
</td>
<td>
2002
</td>
<td>
6
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
24.0
</td>
<td>
24000.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
31858
</th>
<td>
31859
</td>
<td>
3
</td>
<td>
24
</td>
<td>
2001
</td>
<td>
2
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
60.0
</td>
<td>
60000.0
</td>
</tr>
<tr>
<th>
32909
</th>
<td>
32910
</td>
<td>
10
</td>
<td>
14
</td>
<td>
2001
</td>
<td>
4
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
60.0
</td>
<td>
60000.0
</td>
</tr>
<tr>
<th>
34604
</th>
<td>
34605
</td>
<td>
7
</td>
<td>
14
</td>
<td>
2002
</td>
<td>
9
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
60.0
</td>
<td>
60000.0
</td>
</tr>
<tr>
<th>
34675
</th>
<td>
34676
</td>
<td>
9
</td>
<td>
8
</td>
<td>
2002
</td>
<td>
12
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
36.0
</td>
<td>
60.0
</td>
<td>
60000.0
</td>
</tr>
<tr>
<th>
34126
</th>
<td>
34127
</td>
<td>
5
</td>
<td>
16
</td>
<td>
2002
</td>
<td>
9
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
35.0
</td>
<td>
64.0
</td>
<td>
64000.0
</td>
</tr>
</tbody>
</table>
<p>
1229 rows × 10 columns
</p>
<p>As with the dataframe methods above, <code>sort_values()</code> returns a copy of the original dataframe and leaves the original untouched.</p>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<p>Write a query that returns year, species_id, and weight in kg from the surveys_nona table, sorted with the largest weights at the top.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column with weight in kg</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>surveys_nona[<span class="st">"weight_kg"</span>] <span class="op">=</span> surveys_nona[<span class="st">"weight_g"</span>] <span class="op">/</span> <span class="dv">1000</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset containing only year, species_id, and weight_kg</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>subset <span class="op">=</span> surveys_nona[[<span class="st">"year"</span>, <span class="st">"species_id"</span>, <span class="st">"weight_kg"</span>]]</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the subset by weight_kg</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>subset.sort_values(<span class="st">"weight_kg"</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
year
</th>
<th>
species_id
</th>
<th>
weight_kg
</th>
</tr></thead>
<tbody>
<tr>
<th>
33048
</th>
<td>
2001
</td>
<td>
NL
</td>
<td>
0.280
</td>
</tr>
<tr>
<th>
12870
</th>
<td>
1987
</td>
<td>
NL
</td>
<td>
0.278
</td>
</tr>
<tr>
<th>
15458
</th>
<td>
1989
</td>
<td>
NL
</td>
<td>
0.275
</td>
</tr>
<tr>
<th>
2132
</th>
<td>
1979
</td>
<td>
NL
</td>
<td>
0.274
</td>
</tr>
<tr>
<th>
12728
</th>
<td>
1987
</td>
<td>
NL
</td>
<td>
0.270
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
29905
</th>
<td>
1999
</td>
<td>
PP
</td>
<td>
0.004
</td>
</tr>
<tr>
<th>
9908
</th>
<td>
1985
</td>
<td>
RM
</td>
<td>
0.004
</td>
</tr>
<tr>
<th>
10438
</th>
<td>
1985
</td>
<td>
RM
</td>
<td>
0.004
</td>
</tr>
<tr>
<th>
8735
</th>
<td>
1983
</td>
<td>
RM
</td>
<td>
0.004
</td>
</tr>
<tr>
<th>
7083
</th>
<td>
1982
</td>
<td>
PF
</td>
<td>
0.004
</td>
</tr>
</tbody>
</table>
<p>
30676 rows × 3 columns
</p>
</div>
</div>
</div>
</div>
</section><section id="modifying-data"><h2 class="section-heading">Modifying data<a class="anchor" aria-label="anchor" href="#modifying-data"></a>
</h2>
<hr class="half-width">
<p>We’ve already shown how to modify an existing a dataframe by adding a new column. What if we want to modify existing cells instead? As we’ve seen, this can be a little tricky in pandas because most of its methods return a copy of the original dataframe. For example, we can get subsets of a dataframe using square brackets. The cell below returns the species_id column for rows 2 through 5:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>surveys[<span class="dv">2</span>:<span class="dv">6</span>][<span class="st">"species_id"</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>2    DM
3    DM
4    DM
5    PF
Name: species_id, dtype: object</code></pre>
</div>
<p>But trying to set new values using this syntax may not work as expected. When working with the full dataframe, we can use</p>
<p>Say we want to set the species_id column to a new value, “FD”. Try running the code in the cell below:</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>surveys[<span class="dv">2</span>:<span class="dv">6</span>][<span class="st">"species_id"</span>] <span class="op">=</span> <span class="st">"FD"</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>C:\...\1234567890.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  surveys[2:6]["species_id"] = "FD"
</code></pre>
</div>
<p>You should have received a <code>SettingWithCopyWarning</code> warning after running that cell. This warning tells us that the data in the original dataframe has not been modified. This is because the square brackets returned a copy, meaning that any changes will be reflected in the copy, not the original. We can verify that the original dataframe has not been changed by displaying the rows that would have been modified:</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>surveys[<span class="dv">2</span>:<span class="dv">6</span>]</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
2
</th>
<td>
3
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
3
</th>
<td>
4
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
4
</th>
<td>
5
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
5
</th>
<td>
6
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
1
</td>
<td>
PF
</td>
<td>
M
</td>
<td>
14.0
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="using-loc-to-modify-existing-cells">Using loc to modify existing cells<a class="anchor" aria-label="anchor" href="#using-loc-to-modify-existing-cells"></a>
</h3>
<p>One way to modify existing data in pandas is to use the <code>loc</code> attribute. This attribute allows you to extract and modify cells in a DataFrame using the following syntax: <code>df.loc[row_indexer, col_indexer]</code>.</p>
<p>The <em>row_indexer</em> argument is used to select one or more rows. It can be: - A row label (i.e., the bold column on the far left) - <code>0</code> returns the row with label 0</p>
<ul>
<li>A slice including multiple rows:
<ul>
<li>
<code>:</code> returns all rows</li>
<li>
<code>:2</code> returns all rows from the beginning of the dataframe to the row labeled 2, <em>inclusive</em>
</li>
<li>
<code>2:</code> returns all rows from the row labeled 2 to the end of the dataframe, <em>inclusive</em>
</li>
<li>
<code>2:5</code> returns all rows between those labeled 2 and 5, <em>inclusive</em>
</li>
</ul>
</li>
<li>A conditional, as in the examples above.</li>
</ul>
<p>The <em>col_indexer</em> argument is used to select one or more columns. It will typically be a list of column names and can be omitted, in which case all columns will be returned.</p>
<div id="callout2" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="row-labels-and-indexes" class="callout-inner">
<h3 class="callout-title">Row labels and indexes<a class="anchor" aria-label="anchor" href="#row-labels-and-indexes"></a>
</h3>
<div class="callout-content">
<p>The row labels in this dataframe happen to be numeric and aligned exactly to the row’s index (so for the first row both the index and the label are 0, for the second row both the index and the label are 1, etc.) This is often <strong>but not always</strong> true in pandas. For example, if we used record_id as the label, the row labels would be one-based and the row indexes would be zero-based.</p>
</div>
</div>
</div>
<div id="callout3" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="loc-slicing-behavior" class="callout-inner">
<h3 class="callout-title">loc slicing behavior<a class="anchor" aria-label="anchor" href="#loc-slicing-behavior"></a>
</h3>
<div class="callout-content">
<p>Slices using <code>loc</code> are inclusive–rows matching both the start and end values are included in the returned slice. This differs from list slices, where the start but not end value is included in the slice. <code>loc</code> works this way because it is looking at the row <em>label</em>, not the row <em>index</em>.</p>
</div>
</div>
</div>
<p>We’ll be making some changes to our data, so let’s work from a copy instead of modifying the original. Create a copy using the <code>copy()</code> method:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>surveys_copy <span class="op">=</span> surveys.copy()</span></code></pre>
</div>
<p>To select a subset of rows and columns using <code>loc</code>, use:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>surveys_copy.loc[<span class="dv">2</span>:<span class="dv">5</span>, <span class="st">"species_id"</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>2    DM
3    DM
4    DM
5    PF
Name: species_id, dtype: object</code></pre>
</div>
<p>Unlike the methods earlier in the lesson, this is a view, not a copy, of the data in the surveys_copy dataframe. That means that the object returned by loc is live and can be used to change the original dataframe. We can now assign a new value to the species_id column in the matching rows of the original dataframe:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>surveys_copy.loc[<span class="dv">2</span>:<span class="dv">5</span>, <span class="st">"species_id"</span>] <span class="op">=</span> <span class="st">"FD"</span></span></code></pre>
</div>
<p>We can see that these changes are reflected in the original surveys_copy object:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>surveys_copy.loc[<span class="dv">1</span>:<span class="dv">6</span>, <span class="st">"species_id"</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>1    NL
2    FD
3    FD
4    FD
5    FD
6    PE
Name: species_id, dtype: object</code></pre>
</div>
<div id="callout4" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="slicing-with-iloc" class="callout-inner">
<h3 class="callout-title">Slicing with iloc<a class="anchor" aria-label="anchor" href="#slicing-with-iloc"></a>
</h3>
<div class="callout-content">
<p>pandas provides another indexer, <code>iloc</code>, that allows us to select and modify data using row and column indexes instead of labels. Learn more in the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.iloc.html" class="external-link">pandas documentation</a>.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<ul>
<li>Use square brackets to access rows, columns, and specific cells</li>
<li>Use operators like <code>+</code>, <code>-</code>, and <code>/</code> to perform arithmetic on rows and columns</li>
<li>Store the results of calculations in a dataframe by adding a new column or overwriting an existing column</li>
<li>Sort data, rename columns, and get unique values in a dataframe using methods provided by pandas</li>
<li>By default, most dataframe operations return a copy of the original data</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</section></section><section id="aio-04-aggregating-and-grouping-data"><p>Content from <a href="04-aggregating-and-grouping-data.html">Aggregating and Grouping Data</a></p>
<hr>
<p> Last updated on 2022-07-18 | <a href="https://github.com/adamancer/python-ecology-lesson-alt/edit/main/episodes/04-aggregating-and-grouping-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 60 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we calculate summary statistics?</li>
<li>How do we group data?</li>
<li>How do null values affect calculations?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Introduce aggregation calculations in pandas</li>
<li>Introduce grouping in pandas</li>
<li>Learn about how pandas handles null values</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>As always, we’ll begin by importing pandas and reading our CSV:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>surveys <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span></code></pre>
</div>
<section id="aggregating-data"><h2 class="section-heading">Aggregating data<a class="anchor" aria-label="anchor" href="#aggregating-data"></a>
</h2>
<hr class="half-width">
<p>Aggregation allows us to describe the data in our dataframe by calculating totals (like the number of records) and statistics (like the mean value of a column). pandas allows us to run these calculations on dataframes or subsets.</p>
<p>Suppose we need to know how many records are in our dataset. We’ve already seen that we can use the <code>info()</code> method to get high-level about the dataset, including the number of entries. What if just wanted the number of rows? One approach is to use the built-in function <code>len()</code>, which is used to calculate the number of items in an object (for example, the number of characters in a string or the number of items in a list). When used on a dataframe, <code>len()</code> returns the number of rows:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(surveys)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">35549</span></span></code></pre>
</div>
<p>pandas provides a suite of aggregation methods that go beyond this simple case. For example, we can count the number of non-NaN values in each column using <code>count()</code>:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>surveys.count()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>record_id          35549
month              35549
day                35549
year               35549
plot_id            35549
species_id         34786
sex                33038
hindfoot_length    31438
weight             32283
dtype: int64</code></pre>
</div>
<p>Or we can find out the total weight of all individuals in grams using <code>sum()</code>:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>surveys[<span class="st">"weight"</span>].<span class="bu">sum</span>()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1377594.0</span></span></code></pre>
</div>
<p>Other aggregation methods supported by pandas include <code>min()</code>, <code>max()</code>, and <code>mean()</code>. These methods all ignore NaNs, so missing data does not affect these calculations.</p>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<p>Calculate the total weight, average weight, minimum and maximum weights for all animals caught over the duration of the survey. Can you modify your code so that it outputs these values only for weights between 5 and 10 grams?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset of only the animals between 5 and 10 grams</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> surveys[(surveys[<span class="st">"weight"</span>] <span class="op">&gt;</span> <span class="dv">5</span>) <span class="op">&amp;</span> (surveys[<span class="st">"weight"</span>] <span class="op">&lt;</span> <span class="dv">10</span>)][<span class="st">"weight"</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display aggregation calculations using a dict</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sum"</span>: weights.<span class="bu">sum</span>(),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean"</span>: weights.mean(),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"min"</span>: weights.<span class="bu">min</span>(),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"max"</span>: weights.<span class="bu">max</span>(),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{'sum': 16994.0, 'mean': 7.91523055426176, 'min': 6.0, 'max': 9.0}</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>To quickly generate summary statistics, we can use the <code>describe()</code> method instead of calling each aggregation method separately. When we use this method on a dataframe, it calculates stats for all columns with numeric data:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>surveys.describe()</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
count
</th>
<td>
35549.000000
</td>
<td>
35549.000000
</td>
<td>
35549.000000
</td>
<td>
35549.000000
</td>
<td>
35549.000000
</td>
<td>
31438.000000
</td>
<td>
32283.000000
</td>
</tr>
<tr>
<th>
mean
</th>
<td>
17775.000000
</td>
<td>
6.477847
</td>
<td>
15.991195
</td>
<td>
1990.475231
</td>
<td>
11.397001
</td>
<td>
29.287932
</td>
<td>
42.672428
</td>
</tr>
<tr>
<th>
std
</th>
<td>
10262.256696
</td>
<td>
3.396925
</td>
<td>
8.257366
</td>
<td>
7.493355
</td>
<td>
6.799406
</td>
<td>
9.564759
</td>
<td>
36.631259
</td>
</tr>
<tr>
<th>
min
</th>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
1.000000
</td>
<td>
1977.000000
</td>
<td>
1.000000
</td>
<td>
2.000000
</td>
<td>
4.000000
</td>
</tr>
<tr>
<th>
25%
</th>
<td>
8888.000000
</td>
<td>
4.000000
</td>
<td>
9.000000
</td>
<td>
1984.000000
</td>
<td>
5.000000
</td>
<td>
21.000000
</td>
<td>
20.000000
</td>
</tr>
<tr>
<th>
50%
</th>
<td>
17775.000000
</td>
<td>
6.000000
</td>
<td>
16.000000
</td>
<td>
1990.000000
</td>
<td>
11.000000
</td>
<td>
32.000000
</td>
<td>
37.000000
</td>
</tr>
<tr>
<th>
75%
</th>
<td>
26662.000000
</td>
<td>
10.000000
</td>
<td>
23.000000
</td>
<td>
1997.000000
</td>
<td>
17.000000
</td>
<td>
36.000000
</td>
<td>
48.000000
</td>
</tr>
<tr>
<th>
max
</th>
<td>
35549.000000
</td>
<td>
12.000000
</td>
<td>
31.000000
</td>
<td>
2002.000000
</td>
<td>
24.000000
</td>
<td>
70.000000
</td>
<td>
280.000000
</td>
</tr>
</tbody>
</table>
<p>You can see that <code>describe()</code> isn’t picky: It includes both ID and date columns in its results. Notice also that counts differ in between columns. This is because <code>count()</code> only counts non-NaN rows.</p>
<p>If desired, we can also describe a single column at a time:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>surveys[<span class="st">"weight"</span>].describe()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>count    32283.000000
mean        42.672428
std         36.631259
min          4.000000
25%         20.000000
50%         37.000000
75%         48.000000
max        280.000000
Name: weight, dtype: float64</code></pre>
</div>
<p>If we need more control over the output (for example, if we want to calculate the total weight of all animals, as in the challenge above), pandas provides the <code>agg()</code> method, which allows us to specify methods by column. The argument passed to this method is a <code>dict</code>. Each key must be a column name and each value a list of the names of aggregation methods. To calculate the total weight, mean weight, and mean hindfoot length of all records in the survey, we can use:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>surveys.agg({<span class="st">"weight"</span>: [<span class="st">"sum"</span>, <span class="st">"mean"</span>], <span class="st">"hindfoot_length"</span>: [<span class="st">"mean"</span>]})</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
weight
</th>
<th>
hindfoot_length
</th>
</tr></thead>
<tbody>
<tr>
<th>
sum
</th>
<td>
1.377594e+06
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
mean
</th>
<td>
4.267243e+01
</td>
<td>
29.287932
</td>
</tr>
</tbody>
</table></section><section id="grouping-data"><h2 class="section-heading">Grouping data<a class="anchor" aria-label="anchor" href="#grouping-data"></a>
</h2>
<hr class="half-width">
<p>Now, let’s find out how many individuals were counted for each species. We do this using <code>groupby()</code>, which creates an object similar to a dataframe where rows are grouped by the data in one or more columns. To group by species_id, use:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> surveys.groupby(<span class="st">"species_id"</span>)</span></code></pre>
</div>
<p>When we aggregate grouped data, pandas makes separate calculations for each member of the group. In the example below, we’ll calculate the number of times each species appears in the dataset. Rather than outputting the full dataframe, we’ll limit the count to a single column. Because count ignores NaN cells, it’s good practice to use a column that does not contain nulls. Record ID fields are a good choice because they makes it clear that we are counting rows. The fields used to group the data also work.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>grouped[<span class="st">"species_id"</span>].count()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>species_id
AB      303
AH      437
AS        2
BA       46
CB       50
CM       13
CQ       16
CS        1
CT        1
CU        1
CV        1
DM    10596
DO     3027
DS     2504
DX       40
NL     1252
OL     1006
OT     2249
OX       12
PB     2891
PC       39
PE     1299
PF     1597
PG        8
PH       32
PI        9
PL       36
PM      899
PP     3123
PU        5
PX        6
RF       75
RM     2609
RO        8
RX        2
SA       75
SC        1
SF       43
SH      147
SO       43
SS      248
ST        1
SU        5
UL        4
UP        8
UR       10
US        4
ZL        2
Name: species_id, dtype: int64</code></pre>
</div>
<p>To group by multiple columns, we can pass a list to <code>groupby()</code>:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>surveys.groupby([<span class="st">"species_id"</span>, <span class="st">"year"</span>])[<span class="st">"record_id"</span>].count()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>species_id  year
AB          1980     5
            1981     7
            1982    34
            1983    41
            1984    12
                    ..
UR          1994     1
            2001     2
            2002     1
US          2002     4
ZL          1988     2
Name: record_id, Length: 509, dtype: int64</code></pre>
</div>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<p>Write statements that return:</p>
<ol style="list-style-type: decimal">
<li>How many individuals were counted in each year in total</li>
<li>How many were counted each year, for each different species</li>
<li>The average weights of each species in each year</li>
<li>How many individuals were counted for each species that was observed more than 10 times</li>
</ol>
<p>Can you get the answer to both 2 and 3 in a single query?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution to challenge 1
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>How many individuals were counted in each year in total?</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual counts per year</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>surveys.groupby(<span class="st">"year"</span>)[<span class="st">"record_id"</span>].count()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>year
1977     503
1978    1048
1979     719
1980    1415
1981    1472
1982    1978
1983    1673
1984     981
1985    1438
1986     942
1987    1671
1988    1469
1989    1569
1990    1311
1991    1347
1992    1038
1993     750
1994     668
1995    1222
1996    1706
1997    2493
1998    1610
1999    1135
2000    1552
2001    1610
2002    2229
Name: record_id, dtype: int64</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution to challenge 2
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>How many individuals were counted each year, for each different species?</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual counts by species and year</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> surveys.groupby([<span class="st">"year"</span>, <span class="st">"species_id"</span>])[<span class="st">"record_id"</span>].count()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the option_context context manager to show all rows</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pd.option_context(<span class="st">"display.max_rows"</span>, <span class="va">None</span>):</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(result)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>year  species_id
1977  DM            264
      DO             12
      DS             98
      NL             31
      OL             10
      OT             17
      OX              7
      PE              6
      PF             31
      PP              7
      RM              2
      SH              1
      SS              1
1978  AH              1
      DM            389
      DO             22
      DS            320
      NL             48
      OL             47
      OT             66
      OX              1
      PE             17
      PF             40
      PM              3
      PP             24
      RM              3
      SA              2
      SH              1
      SS              8
1979  DM            209
      DO             31
      DS            204
      NL             30
      OL             46
      OT             68
      PE             17
      PF             19
      PM              6
      PP             20
      RM              6
      SS              2
1980  AB              5
      CB              1
      CM             12
      CQ              2
      DM            493
      DO             89
      DS            346
      DX              1
      NL             57
      OL             85
      OT             96
      PE             20
      PF             95
      PM              1
      PP             17
      RM             46
      SS              9
1981  AB              7
      CB              1
      CQ              4
      DM            559
      DO            123
      DS            354
      NL             63
      OL             55
      OT             65
      PE             43
      PF             59
      PM             16
      PP             20
      RM             29
      SA             11
      SS              8
1982  AB             34
      AH              1
      CQ              8
      DM            609
      DO            117
      DS            354
      NL            111
      OL             83
      OT             94
      OX              1
      PC              2
      PE            107
      PF            152
      PM             72
      PP             32
      RF              2
      RM            154
      SA             17
      SH              2
      SS             12
1983  AB             41
      AH              2
      CB              3
      DM            528
      DO            167
      DS            280
      DX              1
      NL             98
      OL             65
      OT             86
      PC              3
      PE             38
      PF            114
      PG              1
      PM             42
      PP             32
      RM            127
      SA             10
      SH              2
      SS             12
1984  AB             12
      AH              2
      CB              1
      CQ              2
      DM            396
      DO            108
      DS             76
      NL             64
      OL             71
      OT             49
      OX              1
      PE             20
      PF              7
      PH              7
      PM             12
      PP             26
      PU              2
      RM             60
      SA             20
      SS             15
1985  AB             14
      AH             14
      CB              1
      DM            667
      DO            225
      DS             98
      NL             45
      OL             94
      OT             62
      PE             51
      PF              1
      PH              3
      PM             17
      PP             35
      RM             72
      SA              3
      SS             14
1986  AB              5
      AH             19
      CB              4
      DM            406
      DO            115
      DS             88
      DX              1
      NL             60
      OL             43
      OT             25
      PE             26
      PF              2
      PH              1
      PM             34
      PP             26
      RM             53
      SA              1
      SH              1
      SS             12
1987  AB             35
      AH             41
      CB              5
      CM              1
      CV              1
      DM            469
      DO            213
      DS            104
      NL            128
      OL             79
      OT             43
      PC              5
      PE            142
      PF              4
      PM            133
      PP             45
      RM            189
      SA              1
      SH              5
      SS             20
      UP              2
      UR              3
1988  AB             39
      AH             26
      CB              6
      DM            365
      DO            144
      DS             54
      DX              1
      NL            102
      OL             51
      OT             86
      PE            190
      PF              2
      PG              2
      PH              1
      PM             54
      PP             53
      RF             11
      RM            211
      SA              1
      SH             31
      SS             20
      UL              1
      UP              3
      UR              1
      ZL              2
1989  AB             31
      AH             30
      BA              3
      CB              1
      CS              1
      DM            321
      DO            119
      DS             33
      NL             67
      OL             57
      OT            102
      OX              1
      PC              1
      PE            177
      PF             13
      PH              2
      PM             27
      PP             45
      RF             49
      RM            398
      SA              3
      SC              1
      SF              5
      SH             55
      SS             18
      UP              2
1990  AB             27
      AH             22
      BA             11
      DM            462
      DO            171
      DS             17
      NL             29
      OL             25
      OT             77
      PC              8
      PE             75
      PF             51
      PG              4
      PH              7
      PP             34
      RF             12
      RM            231
      SF             18
      SH              9
      SS              5
      UP              1
1991  AB             15
      AH             21
      AS              1
      BA             26
      CB              2
      DM            404
      DO            122
      DS             11
      DX              4
      NL             30
      OL             36
      OT            107
      PC              6
      PE             65
      PF             62
      PP             88
      RM            307
      RO              1
      SA              2
      SF              7
      SH              1
      SO             11
      SS              2
      UR              1
1992  AB             10
      AH             16
      BA              6
      CB              7
      DM            307
      DO             94
      DS             18
      DX             12
      NL             15
      OL             45
      OT             42
      PC              9
      PE             41
      PF             57
      PH              7
      PI              1
      PP            131
      RM            158
      SF              3
      SO             20
      SS              7
      UL              1
      UR              1
1993  AB              9
      AH             15
      AS              1
      CB              5
      CU              1
      DM            253
      DO             29
      DS             18
      DX              3
      NL             24
      OL             35
      OT             22
      OX              1
      PC              1
      PE             13
      PF             70
      PP            100
      RM            103
      SF              3
      SO              6
      SS              1
      ST              1
1994  AB              7
      AH             19
      CB              1
      DM            293
      DO             25
      DS              9
      DX              2
      NL             10
      OL             21
      OT             21
      PC              1
      PE              3
      PF             73
      PP             74
      PU              2
      RM             40
      SO              3
      SS              7
      SU              1
      UL              2
      UR              1
1995  AB              4
      AH             36
      CB              2
      DM            436
      DO             58
      DX              3
      NL              8
      OL             29
      OT             38
      PB              7
      PC              1
      PE             14
      PF            158
      PH              3
      PI              1
      PL              3
      PM              8
      PP            277
      PU              1
      RM             81
      RX              1
      SS              7
      SU              4
1996  AH             25
      DM            492
      DO            174
      DX              1
      NL              7
      OL             13
      OT            108
      PB             39
      PC              1
      PE             36
      PF            330
      PL              6
      PM             50
      PP            298
      PX              2
      RM             90
      SA              1
      SS             16
1997  AH             37
      CB              3
      DM            576
      DO            253
      DS              6
      NL             48
      OL              8
      OT            258
      PB            259
      PE             57
      PF            186
      PH              1
      PL             19
      PM            271
      PP            325
      PX              2
      RF              1
      RM            158
      RX              1
      SA              1
      SH              7
      SO              3
      SS             12
1998  AB              2
      AH             33
      CB              4
      CT              1
      DM            503
      DO            111
      DS              9
      DX              2
      NL             32
      OT            164
      PB            329
      PC              1
      PE             24
      PF             26
      PL              7
      PM            103
      PP            208
      PX              1
      RM             13
      SA              2
      SS             15
1999  AH             14
      DM            348
      DO             84
      DS              7
      DX              3
      NL             20
      OT            105
      PB            272
      PE              7
      PM             44
      PP            167
      RM             28
      SH              2
      SS              7
2000  AB              3
      AH             12
      DM            233
      DO             91
      DX              4
      NL             29
      OT            154
      PB            555
      PE             15
      PG              1
      PL              1
      PM              2
      PP            381
      PX              1
      RM             15
      SH              8
      SS              4
2001  AB              1
      AH             23
      CB              3
      DM            305
      DO             81
      DX              1
      NL             48
      OT            167
      PB            538
      PE             35
      PF             27
      PI              2
      PM              3
      PP            273
      RM             15
      SH             11
      SS              5
      UR              2
2002  AB              2
      AH             28
      DM            309
      DO            249
      DX              1
      NL             48
      OL              8
      OT            127
      PB            892
      PE             60
      PF             18
      PI              5
      PM              1
      PP            385
      RM             20
      RO              7
      SF              7
      SH             11
      SS              9
      UR              1
      US              4
Name: record_id, dtype: int64
</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Show me the solution to challenge 3
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>What was the average weight of each species in each year?</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean weight by species and year</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> surveys.groupby([<span class="st">"year"</span>, <span class="st">"species_id"</span>])[<span class="st">"weight"</span>].mean()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the option_context context manager to show all rows</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pd.option_context(<span class="st">"display.max_rows"</span>, <span class="va">None</span>):</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(result)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>year  species_id
1977  DM             41.141304
      DO             42.666667
      DS            121.437500
      NL                   NaN
      OL             21.666667
      OT             21.000000
      OX             21.333333
      PE             19.500000
      PF              7.173913
      PP             15.333333
      RM             10.000000
      SH                   NaN
      SS                   NaN
1978  AH                   NaN
      DM             40.795455
      DO             45.000000
      DS            115.198653
      NL            184.656250
      OL             31.027027
      OT             23.220000
      OX                   NaN
      PE             20.428571
      PF              7.088235
      PM             20.666667
      PP             14.869565
      RM              7.500000
      SA                   NaN
      SH             89.000000
      SS            130.000000
1979  DM             43.507317
      DO             45.862069
      DS            111.796954
      NL            138.000000
      OL             33.717391
      OT             23.075758
      PE             20.529412
      PF              7.529412
      PM             23.666667
      PP             15.105263
      RM              8.333333
      SS                   NaN
1980  AB                   NaN
      CB                   NaN
      CM                   NaN
      CQ                   NaN
      DM             44.136082
      DO             48.058824
      DS            120.725664
      DX                   NaN
      NL            158.982143
      OL             33.107143
      OT             24.083333
      PE             22.450000
      PF              7.455556
      PM             21.000000
      PP             14.176471
      RM             10.227273
      SS                   NaN
1981  AB                   NaN
      CB                   NaN
      CQ                   NaN
      DM             44.032907
      DO             49.111111
      DS            125.818444
      NL            165.903226
      OL             33.296296
      OT             24.415385
      PE             20.558140
      PF              7.152542
      PM             19.933333
      PP             13.950000
      RM             11.178571
      SA                   NaN
      SS             57.000000
1982  AB                   NaN
      AH                   NaN
      CQ                   NaN
      DM             41.975042
      DO             47.919643
      DS            115.647929
      NL            160.613208
      OL             35.590361
      OT             24.925532
      OX             24.000000
      PC                   NaN
      PE             21.173077
      PF              6.918919
      PM             21.391304
      PP             16.125000
      RF             11.500000
      RM             10.436242
      SA                   NaN
      SH             79.000000
      SS                   NaN
1983  AB                   NaN
      AH                   NaN
      CB                   NaN
      DM             40.944551
      DO             47.150602
      DS            122.033088
      DX                   NaN
      NL            156.691489
      OL             34.584615
      OT             24.697674
      PC                   NaN
      PE             20.864865
      PF              6.833333
      PG                   NaN
      PM             22.023810
      PP             15.468750
      RM              9.872000
      SA                   NaN
      SH                   NaN
      SS                   NaN
1984  AB                   NaN
      AH                   NaN
      CB                   NaN
      CQ                   NaN
      DM             40.765306
      DO             48.415094
      DS            124.082192
      NL            150.095238
      OL             32.550725
      OT             22.416667
      OX             18.000000
      PE             20.210526
      PF              7.428571
      PH             28.000000
      PM             19.545455
      PP             15.307692
      PU                   NaN
      RM             11.152542
      SA                   NaN
      SS                   NaN
1985  AB                   NaN
      AH                   NaN
      CB                   NaN
      DM             41.507645
      DO             47.956731
      DS            124.326316
      NL            148.829268
      OL             32.108696
      OT             22.064516
      PE             20.360000
      PF                   NaN
      PH             32.666667
      PM             19.000000
      PP             15.764706
      RM              8.371429
      SA                   NaN
      SS                   NaN
1986  AB                   NaN
      AH                   NaN
      CB                   NaN
      DM             43.361596
      DO             49.372727
      DS            128.071429
      DX                   NaN
      NL            159.724138
      OL             30.880952
      OT             21.500000
      PE             22.520000
      PF              8.000000
      PH             39.000000
      PM             21.696970
      PP             16.750000
      RM             10.750000
      SA                   NaN
      SH             55.000000
      SS                   NaN
1987  AB                   NaN
      AH                   NaN
      CB                   NaN
      CM                   NaN
      CV                   NaN
      DM             43.232609
      DO             50.087379
      DS            126.383838
      NL            158.840000
      OL             30.779221
      OT             23.069767
      PC                   NaN
      PE             21.625899
      PF              7.500000
      PM             22.297710
      PP             17.840909
      RM             10.657609
      SA                   NaN
      SH             73.800000
      SS                   NaN
      UP                   NaN
      UR                   NaN
1988  AB                   NaN
      AH                   NaN
      CB                   NaN
      DM             43.397790
      DO             51.463768
      DS            129.490566
      DX                   NaN
      NL            163.104167
      OL             30.306122
      OT             24.070588
      PE             22.625668
      PF              8.000000
      PG                   NaN
      PH             33.000000
      PM             21.759259
      PP             18.280000
      RF             13.818182
      RM             10.322115
      SA                   NaN
      SH             72.806452
      SS                   NaN
      UL                   NaN
      UP                   NaN
      UR                   NaN
      ZL                   NaN
1989  AB                   NaN
      AH                   NaN
      BA              7.000000
      CB                   NaN
      CS                   NaN
      DM             44.349206
      DO             51.025641
      DS            121.896552
      NL            151.278689
      OL             31.947368
      OT             24.663366
      OX             20.000000
      PC                   NaN
      PE             21.935673
      PF              7.230769
      PH             30.500000
      PM             20.222222
      PP             17.409091
      RF             13.346939
      RM             10.411311
      SA                   NaN
      SC                   NaN
      SF             54.800000
      SH             76.345455
      SS                   NaN
      UP                   NaN
1990  AB                   NaN
      AH                   NaN
      BA              8.000000
      DM             41.769912
      DO             48.512048
      DS            121.187500
      NL            154.275862
      OL             31.200000
      OT             23.675325
      PC                   NaN
      PE             21.671233
      PF              7.117647
      PG                   NaN
      PH             31.142857
      PP             16.029412
      RF             12.916667
      RM             10.305677
      SF             52.611111
      SH             76.888889
      SS                   NaN
      UP                   NaN
1991  AB                   NaN
      AH                   NaN
      AS                   NaN
      BA              9.240000
      CB                   NaN
      DM             43.148338
      DO             49.695652
      DS            113.000000
      DX                   NaN
      NL            148.785714
      OL             28.171429
      OT             24.588235
      PC                   NaN
      PE             21.435484
      PF              7.827586
      PP             17.904762
      RM             10.498305
      RO             11.000000
      SA                   NaN
      SF             93.166667
      SH             63.000000
      SO             53.909091
      SS                   NaN
      UR                   NaN
1992  AB                   NaN
      AH                   NaN
      BA              7.833333
      CB                   NaN
      DM             43.877966
      DO             48.367816
      DS            112.352941
      DX                   NaN
      NL            139.000000
      OL             28.454545
      OT             24.928571
      PC                   NaN
      PE             22.750000
      PF              8.767857
      PH             31.142857
      PI             18.000000
      PP             17.479675
      RM             10.904762
      SF             43.000000
      SO             55.263158
      SS                   NaN
      UL                   NaN
      UR                   NaN
1993  AB                   NaN
      AH                   NaN
      AS                   NaN
      CB                   NaN
      CU                   NaN
      DM             43.373984
      DO             48.461538
      DS            105.722222
      DX                   NaN
      NL            127.391304
      OL             27.545455
      OT             22.363636
      OX                   NaN
      PC                   NaN
      PE             19.230769
      PF              8.238806
      PP             17.954023
      RM             10.747475
      SF             44.000000
      SO             55.600000
      SS                   NaN
      ST                   NaN
1994  AB                   NaN
      AH                   NaN
      CB                   NaN
      DM             42.373288
      DO             47.750000
      DS            106.625000
      DX                   NaN
      NL            186.875000
      OL             21.900000
      OT             25.285714
      PC                   NaN
      PE             18.000000
      PF              7.855072
      PP             17.585714
      PU                   NaN
      RM             10.675000
      SO             62.333333
      SS                   NaN
      SU                   NaN
      UL                   NaN
      UR                   NaN
1995  AB                   NaN
      AH                   NaN
      CB                   NaN
      DM             44.806147
      DO             49.592593
      DX                   NaN
      NL            155.833333
      OL             27.296296
      OT             24.868421
      PB             34.000000
      PC                   NaN
      PE             21.230769
      PF              8.780645
      PH             35.333333
      PI                   NaN
      PL             22.333333
      PM             27.375000
      PP             16.844444
      PU                   NaN
      RM             12.653846
      RX             20.000000
      SS                   NaN
      SU                   NaN
1996  AH                   NaN
      DM             44.506173
      DO             47.234940
      DX                   NaN
      NL            148.000000
      OL             27.769231
      OT             23.453704
      PB             32.578947
      PC                   NaN
      PE             22.027778
      PF              8.393846
      PL             21.166667
      PM             20.224490
      PP             18.095563
      PX                   NaN
      RM             11.455556
      SA                   NaN
      SS                   NaN
1997  AH                   NaN
      CB                   NaN
      DM             44.708551
      DO             48.177866
      DS            111.000000
      NL            150.688889
      OL             33.625000
      OT             24.785156
      PB             31.085603
      PE             20.929825
      PF              8.448649
      PH             22.000000
      PL             18.789474
      PM             21.126394
      PP             18.175000
      PX             19.000000
      RF             20.000000
      RM             11.230769
      RX             11.000000
      SA                   NaN
      SH             50.857143
      SO             54.666667
      SS                   NaN
1998  AB                   NaN
      AH                   NaN
      CB                   NaN
      CT                   NaN
      DM             43.131403
      DO             49.731183
      DS            116.000000
      DX                   NaN
      NL            159.466667
      OT             24.675676
      PB             30.082237
      PC                   NaN
      PE             20.304348
      PF              8.720000
      PL             16.714286
      PM             20.591398
      PP             16.266990
      PX                   NaN
      RM             13.100000
      SA                   NaN
      SS                   NaN
1999  AH                   NaN
      DM             43.945402
      DO             48.012048
      DS            120.714286
      DX                   NaN
      NL            182.200000
      OT             25.723810
      PB             31.710037
      PE             25.428571
      PM             22.523810
      PP             16.521212
      RM             10.555556
      SH             54.000000
      SS                   NaN
2000  AB                   NaN
      AH                   NaN
      DM             43.126638
      DO             49.224719
      DX                   NaN
      NL            179.307692
      OT             25.303448
      PB             30.878899
      PE             21.615385
      PG                   NaN
      PL             21.000000
      PM             20.500000
      PP             16.788618
      PX                   NaN
      RM             11.400000
      SH             73.375000
      SS                   NaN
2001  AB                   NaN
      AH                   NaN
      CB                   NaN
      DM             45.442177
      DO             52.233766
      DX                   NaN
      NL            167.851064
      OT             23.707792
      PB             32.798851
      PE             20.400000
      PF              8.538462
      PI             18.000000
      PM             26.666667
      PP             17.752896
      RM             11.333333
      SH             79.900000
      SS                   NaN
      UR                   NaN
2002  AB                   NaN
      AH                   NaN
      DM             46.168317
      DO             49.514403
      DX                   NaN
      NL            182.159091
      OL             25.428571
      OT             23.833333
      PB             32.359447
      PE             21.719298
      PF              7.388889
      PI             20.000000
      PM             19.000000
      PP             17.018617
      RM             10.000000
      RO             10.142857
      SF             62.166667
      SH             64.666667
      SS                   NaN
      UR                   NaN
      US                   NaN
Name: weight, dtype: float64
</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Show me the solution to challenge 4
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>How many individuals were counted for each species that was observed more than 10 times?</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Counts by species that appear more than 10 times</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>species <span class="op">=</span> surveys.groupby(<span class="st">"species_id"</span>)[<span class="st">"record_id"</span>].count()</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>species[species <span class="op">&gt;</span> <span class="dv">10</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>species_id
AB      303
AH      437
BA       46
CB       50
CM       13
CQ       16
DM    10596
DO     3027
DS     2504
DX       40
NL     1252
OL     1006
OT     2249
OX       12
PB     2891
PC       39
PE     1299
PF     1597
PH       32
PL       36
PM      899
PP     3123
RF       75
RM     2609
SA       75
SF       43
SH      147
SO       43
SS      248
Name: record_id, dtype: int64</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  Show me the solution to challenges 2 and 3 combined
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<p>Calculate the number of individuals observed and the average weight for each species in each year.</p>
<p>Note that weight contains NaNs, so counts for record_id and weight differ.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Counts and mean weight by species and year</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>surveys.groupby([<span class="st">"year"</span>, <span class="st">"species_id"</span>]).agg(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    {<span class="st">"record_id"</span>: <span class="st">"count"</span>, <span class="st">"weight"</span>: [<span class="st">"count"</span>, <span class="st">"mean"</span>]}</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead>
<tr>
<th>
</th>
<th>
</th>
<th>
record_id
</th>
<th colspan="2" halign="left">
weight
</th>
</tr>
<tr>
<th>
</th>
<th>
</th>
<th>
count
</th>
<th>
count
</th>
<th>
mean
</th>
</tr>
<tr>
<th>
year
</th>
<th>
species_id
</th>
<th>
</th>
<th>
</th>
<th>
</th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="5" valign="top">
1977
</th>
<th>
DM
</th>
<td>
264
</td>
<td>
184
</td>
<td>
41.141304
</td>
</tr>
<tr>
<th>
DO
</th>
<td>
12
</td>
<td>
12
</td>
<td>
42.666667
</td>
</tr>
<tr>
<th>
DS
</th>
<td>
98
</td>
<td>
32
</td>
<td>
121.437500
</td>
</tr>
<tr>
<th>
NL
</th>
<td>
31
</td>
<td>
0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
OL
</th>
<td>
10
</td>
<td>
3
</td>
<td>
21.666667
</td>
</tr>
<tr>
<th>
…
</th>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th rowspan="5" valign="top">
2002
</th>
<th>
SF
</th>
<td>
7
</td>
<td>
6
</td>
<td>
62.166667
</td>
</tr>
<tr>
<th>
SH
</th>
<td>
11
</td>
<td>
9
</td>
<td>
64.666667
</td>
</tr>
<tr>
<th>
SS
</th>
<td>
9
</td>
<td>
0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
UR
</th>
<td>
1
</td>
<td>
0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
US
</th>
<td>
4
</td>
<td>
0
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>
509 rows × 3 columns
</p>
</div>
</div>
</div>
</div>
</section><section id="handling-missing-data"><h2 class="section-heading">Handling missing data<a class="anchor" aria-label="anchor" href="#handling-missing-data"></a>
</h2>
<hr class="half-width">
<p>As we’ve discussed, some columns in the surveys dataframe have the value NaN instead of text or numbers. NaN, short for “not a number,” is a special type of float used by pandas to represent missing data. When reading from a CSV, as we have done throughout this lesson, pandas interprets certains values as NaN (see <em>na_values</em> in the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html" class="external-link">pd.read_csv() documentation</a> for the default list). NaNs are excluded from groups and most aggregation calculations in pandas, including counts.</p>
<p>It is crucial to understand how missing data is represented in a dataset. Failing to do so may introduce errors into our analysis. The ecology dataset used in this lesson uses empty cells to represent missing data, but other disciplines have different conventions. For example, some geographic datasets use -9999 to represent null values. Failure to convert such values to NaN will result in significant errors on any calculations performed on that dataset.</p>
<p>In some cases, it can be useful to fill in cells containing NaN with a non-null value. For example, the <code>groupby()</code> method excludes NaN cells. When looking at sex, the following code counts only those cells with either F (female) or M (male):</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>surveys.groupby(<span class="st">"sex"</span>)[<span class="st">"record_id"</span>].count()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>sex
F    15690
M    17348
Name: record_id, dtype: int64</code></pre>
</div>
<p>But not all records specify a sex. To include records where sex was not specified, we can use the <code>fillna()</code> method on the sex column. This method replaces each NaN cell with the value passed as the first argument to the function call. To replace all NaN values in sex with “U”, use:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>surveys[<span class="st">"sex"</span>] <span class="op">=</span> surveys[<span class="st">"sex"</span>].fillna(<span class="st">"U"</span>)</span></code></pre>
</div>
<p>The grouped calculation now accounts for all records in the dataframe:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>surveys.groupby(<span class="st">"sex"</span>)[<span class="st">"record_id"</span>].count()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>sex
F    15690
M    17348
U     2511
Name: record_id, dtype: int64</code></pre>
</div>
<p>In other cases, we may want to ignore rows that contain NaNs. This can be done using <code>dropna()</code>:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>surveys.dropna()</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
62
</th>
<td>
63
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
40.0
</td>
</tr>
<tr>
<th>
63
</th>
<td>
64
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
48.0
</td>
</tr>
<tr>
<th>
64
</th>
<td>
65
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
4
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
34.0
</td>
<td>
29.0
</td>
</tr>
<tr>
<th>
65
</th>
<td>
66
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
4
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
35.0
</td>
<td>
46.0
</td>
</tr>
<tr>
<th>
66
</th>
<td>
67
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
36.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35540
</th>
<td>
35541
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
24.0
</td>
<td>
31.0
</td>
</tr>
<tr>
<th>
35541
</th>
<td>
35542
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
26.0
</td>
<td>
29.0
</td>
</tr>
<tr>
<th>
35542
</th>
<td>
35543
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
27.0
</td>
<td>
34.0
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
35547
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
</tr>
</tbody>
</table>
<p>
30738 rows × 9 columns
</p>
<p>This method returns a copy of the dataframe containing only those rows that have valid data in every field.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<ul>
<li>Calculate individual summary statistics using dataframe methods like <code>mean()</code>, <code>max()</code>, and <code>min()</code>
</li>
<li>Calculate multiple summary statistics at once using the dataframe methods <code>describe()</code> and <code>agg()</code>
</li>
<li>Group data by one or more columns using the <code>groupby()</code> method</li>
<li>pandas uses NaN to represent missing data in a dataframe</li>
<li>Failing to consider how missing data is interpreted in a dataset can introduce errors into calculations</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-05-combining-data-with-joins"><p>Content from <a href="05-combining-data-with-joins.html">Combining Dataframes</a></p>
<hr>
<p> Last updated on 2022-07-18 | <a href="https://github.com/adamancer/python-ecology-lesson-alt/edit/main/episodes/05-combining-data-with-joins.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 60 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do we combine data from multiple sources using pandas?</li>
<li>How do we add data to an existing dataframe?</li>
<li>How do we split and combine data columns?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use <code>pd.merge()</code> to add species info to the survey dataset</li>
<li>Use <code>pd.concat()</code> to add additional rows the dataset</li>
<li>Use string methods to combine, split, and modify text columns using the <code>str</code> accessor</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Dataframes can be used to organize and group data by common characteristics. Often, we need to combine elements from separate dataframes into one for analysis and visualization. A merge (or join) allows use to combine two dataframes using values common to each. Likewise, we may need to append data collected under different circumstances. In this chapter, we will show how to merge, concatenate, and split data using pandas.</p>
<section id="merging-dataframes"><h2 class="section-heading">Merging dataframes<a class="anchor" aria-label="anchor" href="#merging-dataframes"></a>
</h2>
<hr class="half-width">
<p>The survey dataframe we’ve been using throughout this lesson has a column called species_id. We used this column in the previous lesson to calculate summary statistics about observations of each species. But the species_id is just a two-letter code—what does each code stand for? To find out, we’ll now load both the survey dataset and a second dataset containing more detailed information about the various species observed. Read the second dataframe from a file called species.csv:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>surveys <span class="op">=</span> pd.read_csv(<span class="st">"data/surveys.csv"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>species <span class="op">=</span> pd.read_csv(<span class="st">"data/species.csv"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>species</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
species_id
</th>
<th>
genus
</th>
<th>
species
</th>
<th>
taxa
</th>
</tr></thead>
<tbody>
<tr>
<th>
0
</th>
<td>
AB
</td>
<td>
Amphispiza
</td>
<td>
bilineata
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
1
</th>
<td>
AH
</td>
<td>
Ammospermophilus
</td>
<td>
harrisi
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
2
</th>
<td>
AS
</td>
<td>
Ammodramus
</td>
<td>
savannarum
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
3
</th>
<td>
BA
</td>
<td>
Baiomys
</td>
<td>
taylori
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
4
</th>
<td>
CB
</td>
<td>
Campylorhynchus
</td>
<td>
brunneicapillus
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
5
</th>
<td>
CM
</td>
<td>
Calamospiza
</td>
<td>
melanocorys
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
6
</th>
<td>
CQ
</td>
<td>
Callipepla
</td>
<td>
squamata
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
7
</th>
<td>
CS
</td>
<td>
Crotalus
</td>
<td>
scutalatus
</td>
<td>
Reptile
</td>
</tr>
<tr>
<th>
8
</th>
<td>
CT
</td>
<td>
Cnemidophorus
</td>
<td>
tigris
</td>
<td>
Reptile
</td>
</tr>
<tr>
<th>
9
</th>
<td>
CU
</td>
<td>
Cnemidophorus
</td>
<td>
uniparens
</td>
<td>
Reptile
</td>
</tr>
<tr>
<th>
10
</th>
<td>
CV
</td>
<td>
Crotalus
</td>
<td>
viridis
</td>
<td>
Reptile
</td>
</tr>
<tr>
<th>
11
</th>
<td>
DM
</td>
<td>
Dipodomys
</td>
<td>
merriami
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
12
</th>
<td>
DO
</td>
<td>
Dipodomys
</td>
<td>
ordii
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
13
</th>
<td>
DS
</td>
<td>
Dipodomys
</td>
<td>
spectabilis
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
14
</th>
<td>
DX
</td>
<td>
Dipodomys
</td>
<td>
sp.
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
15
</th>
<td>
EO
</td>
<td>
Eumeces
</td>
<td>
obsoletus
</td>
<td>
Reptile
</td>
</tr>
<tr>
<th>
16
</th>
<td>
GS
</td>
<td>
Gambelia
</td>
<td>
silus
</td>
<td>
Reptile
</td>
</tr>
<tr>
<th>
17
</th>
<td>
NL
</td>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
18
</th>
<td>
NX
</td>
<td>
Neotoma
</td>
<td>
sp.
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
19
</th>
<td>
OL
</td>
<td>
Onychomys
</td>
<td>
leucogaster
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
20
</th>
<td>
OT
</td>
<td>
Onychomys
</td>
<td>
torridus
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
21
</th>
<td>
OX
</td>
<td>
Onychomys
</td>
<td>
sp.
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
22
</th>
<td>
PB
</td>
<td>
Chaetodipus
</td>
<td>
baileyi
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
23
</th>
<td>
PC
</td>
<td>
Pipilo
</td>
<td>
chlorurus
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
24
</th>
<td>
PE
</td>
<td>
Peromyscus
</td>
<td>
eremicus
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
25
</th>
<td>
PF
</td>
<td>
Perognathus
</td>
<td>
flavus
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
26
</th>
<td>
PG
</td>
<td>
Pooecetes
</td>
<td>
gramineus
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
27
</th>
<td>
PH
</td>
<td>
Perognathus
</td>
<td>
hispidus
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
28
</th>
<td>
PI
</td>
<td>
Chaetodipus
</td>
<td>
intermedius
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
29
</th>
<td>
PL
</td>
<td>
Peromyscus
</td>
<td>
leucopus
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
30
</th>
<td>
PM
</td>
<td>
Peromyscus
</td>
<td>
maniculatus
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
31
</th>
<td>
PP
</td>
<td>
Chaetodipus
</td>
<td>
penicillatus
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
32
</th>
<td>
PU
</td>
<td>
Pipilo
</td>
<td>
fuscus
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
33
</th>
<td>
PX
</td>
<td>
Chaetodipus
</td>
<td>
sp.
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
34
</th>
<td>
RF
</td>
<td>
Reithrodontomys
</td>
<td>
fulvescens
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
35
</th>
<td>
RM
</td>
<td>
Reithrodontomys
</td>
<td>
megalotis
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
36
</th>
<td>
RO
</td>
<td>
Reithrodontomys
</td>
<td>
montanus
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
37
</th>
<td>
RX
</td>
<td>
Reithrodontomys
</td>
<td>
sp.
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
38
</th>
<td>
SA
</td>
<td>
Sylvilagus
</td>
<td>
audubonii
</td>
<td>
Rabbit
</td>
</tr>
<tr>
<th>
39
</th>
<td>
SB
</td>
<td>
Spizella
</td>
<td>
breweri
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
40
</th>
<td>
SC
</td>
<td>
Sceloporus
</td>
<td>
clarki
</td>
<td>
Reptile
</td>
</tr>
<tr>
<th>
41
</th>
<td>
SF
</td>
<td>
Sigmodon
</td>
<td>
fulviventer
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
42
</th>
<td>
SH
</td>
<td>
Sigmodon
</td>
<td>
hispidus
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
43
</th>
<td>
SO
</td>
<td>
Sigmodon
</td>
<td>
ochrognathus
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
44
</th>
<td>
SS
</td>
<td>
Spermophilus
</td>
<td>
spilosoma
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
45
</th>
<td>
ST
</td>
<td>
Spermophilus
</td>
<td>
tereticaudus
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
46
</th>
<td>
SU
</td>
<td>
Sceloporus
</td>
<td>
undulatus
</td>
<td>
Reptile
</td>
</tr>
<tr>
<th>
47
</th>
<td>
SX
</td>
<td>
Sigmodon
</td>
<td>
sp.
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
48
</th>
<td>
UL
</td>
<td>
Lizard
</td>
<td>
sp.
</td>
<td>
Reptile
</td>
</tr>
<tr>
<th>
49
</th>
<td>
UP
</td>
<td>
Pipilo
</td>
<td>
sp.
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
50
</th>
<td>
UR
</td>
<td>
Rodent
</td>
<td>
sp.
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
51
</th>
<td>
US
</td>
<td>
Sparrow
</td>
<td>
sp.
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
52
</th>
<td>
ZL
</td>
<td>
Zonotrichia
</td>
<td>
leucophrys
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
53
</th>
<td>
ZM
</td>
<td>
Zenaida
</td>
<td>
macroura
</td>
<td>
Bird
</td>
</tr>
</tbody>
</table>
<p>We can see that the species dataframe includes a genus, species, and taxon for each species_id. This is much more useful than the species_id included in the original dataframe–how can we add that data to our surveys dataframe? Adding it by hand would be tedious and error prone. Fortunately, pandas provides the <code>pd.merge()</code> function to join two dataframes.</p>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="managing-repetitive-data" class="callout-inner">
<h3 class="callout-title">Managing repetitive data<a class="anchor" aria-label="anchor" href="#managing-repetitive-data"></a>
</h3>
<div class="callout-content">
<p>Why store species data in a separate table in the first place? Species information is repetitive: Every observation of the same species has the same genus, species, and taxa. Storing it in the original survey table would require including that data in every record, increasing the complexity of the table and creating the possibility of errors. Storing that data in a separate table means we only have to enter and validate it once. A tool like pandas then allows us to access that data when we need it.</p>
</div>
</div>
</div>
<p>To merge the surveys and species dataframes, use:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> pd.merge(surveys, species)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>merged</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
<th>
genus
</th>
<th>
species
</th>
<th>
taxa
</th>
</tr></thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
32.0
</td>
<td>
NaN
</td>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
1
</th>
<td>
2
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
33.0
</td>
<td>
NaN
</td>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
2
</th>
<td>
22
</td>
<td>
7
</td>
<td>
17
</td>
<td>
1977
</td>
<td>
15
</td>
<td>
NL
</td>
<td>
F
</td>
<td>
31.0
</td>
<td>
NaN
</td>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
3
</th>
<td>
38
</td>
<td>
7
</td>
<td>
17
</td>
<td>
1977
</td>
<td>
17
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
33.0
</td>
<td>
NaN
</td>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
4
</th>
<td>
72
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
31.0
</td>
<td>
NaN
</td>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
34781
</th>
<td>
28988
</td>
<td>
12
</td>
<td>
23
</td>
<td>
1998
</td>
<td>
6
</td>
<td>
CT
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
Cnemidophorus
</td>
<td>
tigris
</td>
<td>
Reptile
</td>
</tr>
<tr>
<th>
34782
</th>
<td>
35512
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
11
</td>
<td>
US
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
Sparrow
</td>
<td>
sp.
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
34783
</th>
<td>
35513
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
11
</td>
<td>
US
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
Sparrow
</td>
<td>
sp.
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
34784
</th>
<td>
35528
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
13
</td>
<td>
US
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
Sparrow
</td>
<td>
sp.
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
34785
</th>
<td>
35544
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
US
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
Sparrow
</td>
<td>
sp.
</td>
<td>
Bird
</td>
</tr>
</tbody>
</table>
<p>
34786 rows × 12 columns
</p>
<p>Following the merge, the genus, species, and taxa columns have all been added to the survey dataframe. We can now use those columns to filter and summarize our data.</p>
<div id="callout2" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="joins" class="callout-inner">
<h3 class="callout-title">Joins<a class="anchor" aria-label="anchor" href="#joins"></a>
</h3>
<div class="callout-content">
<p>The <code>pd.merge()</code> method is equivalent to the JOIN operation in SQL</p>
</div>
</div>
</div>
<div id="challenge1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<p>Filter the merged dataframe to show the genus, the species name, and the weight for every individual captured at the site</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>merged[[<span class="st">"genus"</span>, <span class="st">"species"</span>, <span class="st">"weight"</span>]]</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
genus
</th>
<th>
species
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
0
</th>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
1
</th>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
2
</th>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
3
</th>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
4
</th>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
34781
</th>
<td>
Cnemidophorus
</td>
<td>
tigris
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
34782
</th>
<td>
Sparrow
</td>
<td>
sp.
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
34783
</th>
<td>
Sparrow
</td>
<td>
sp.
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
34784
</th>
<td>
Sparrow
</td>
<td>
sp.
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
34785
</th>
<td>
Sparrow
</td>
<td>
sp.
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>
34786 rows × 3 columns
</p>
</div>
</div>
</div>
</div>
<p>In the example above, we didn’t provide any information about how we wanted to merge the dataframes together, so pandas used its default arguments to make an educated guess. It looked at the columns in each of the dataframes, then merged them based on the columns that appear in both. Here, the only shared name is species_id, so that’s the column pandas used to merge. For more complex tables, we may want to specify the columns are used for merging. We can do so by passing one or more column names using the <em>on</em> keyword argument:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pd.merge(surveys, species, on<span class="op">=</span><span class="st">"species_id"</span>)</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
<th>
genus
</th>
<th>
species
</th>
<th>
taxa
</th>
</tr></thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
32.0
</td>
<td>
NaN
</td>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
1
</th>
<td>
2
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
33.0
</td>
<td>
NaN
</td>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
2
</th>
<td>
22
</td>
<td>
7
</td>
<td>
17
</td>
<td>
1977
</td>
<td>
15
</td>
<td>
NL
</td>
<td>
F
</td>
<td>
31.0
</td>
<td>
NaN
</td>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
3
</th>
<td>
38
</td>
<td>
7
</td>
<td>
17
</td>
<td>
1977
</td>
<td>
17
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
33.0
</td>
<td>
NaN
</td>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
4
</th>
<td>
72
</td>
<td>
8
</td>
<td>
19
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
31.0
</td>
<td>
NaN
</td>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
34781
</th>
<td>
28988
</td>
<td>
12
</td>
<td>
23
</td>
<td>
1998
</td>
<td>
6
</td>
<td>
CT
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
Cnemidophorus
</td>
<td>
tigris
</td>
<td>
Reptile
</td>
</tr>
<tr>
<th>
34782
</th>
<td>
35512
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
11
</td>
<td>
US
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
Sparrow
</td>
<td>
sp.
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
34783
</th>
<td>
35513
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
11
</td>
<td>
US
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
Sparrow
</td>
<td>
sp.
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
34784
</th>
<td>
35528
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
13
</td>
<td>
US
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
Sparrow
</td>
<td>
sp.
</td>
<td>
Bird
</td>
</tr>
<tr>
<th>
34785
</th>
<td>
35544
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
US
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
Sparrow
</td>
<td>
sp.
</td>
<td>
Bird
</td>
</tr>
</tbody>
</table>
<p>
34786 rows × 12 columns
</p>
<div id="challenge2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<p>Compare the number of rows in the original and merged survey dataframes. How do they differ? Why do you think that might be?</p>
<p><strong>Hint:</strong> Use <code>pd.unique()</code> method to look at the species_id column in each dataframe.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  Show me the solution
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>pd.unique(surveys[<span class="st">"species_id"</span>].sort_values())</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>array(['AB', 'AH', 'AS', 'BA', 'CB', 'CM', 'CQ', 'CS', 'CT', 'CU', 'CV',
       'DM', 'DO', 'DS', 'DX', 'NL', 'OL', 'OT', 'OX', 'PB', 'PC', 'PE',
       'PF', 'PG', 'PH', 'PI', 'PL', 'PM', 'PP', 'PU', 'PX', 'RF', 'RM',
       'RO', 'RX', 'SA', 'SC', 'SF', 'SH', 'SO', 'SS', 'ST', 'SU', 'UL',
       'UP', 'UR', 'US', 'ZL', nan], dtype=object)</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>pd.unique(species[<span class="st">"species_id"</span>].sort_values())</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>array(['AB', 'AH', 'AS', 'BA', 'CB', 'CM', 'CQ', 'CS', 'CT', 'CU', 'CV',
       'DM', 'DO', 'DS', 'DX', 'EO', 'GS', 'NL', 'NX', 'OL', 'OT', 'OX',
       'PB', 'PC', 'PE', 'PF', 'PG', 'PH', 'PI', 'PL', 'PM', 'PP', 'PU',
       'PX', 'RF', 'RM', 'RO', 'RX', 'SA', 'SB', 'SC', 'SF', 'SH', 'SO',
       'SS', 'ST', 'SU', 'SX', 'UL', 'UP', 'UR', 'US', 'ZL', 'ZM'],
      dtype=object)</code></pre>
</div>
<p>Some records in the surveys dataframe do not specify a species. By default, only records with a value that occurs in both the surveys and species dataframes appear in the merged dataframe, so rows without a species_id are excluded.</p>
<p>The built-in <code>set</code> type can be used to quickly assess differences like this:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(surveys[<span class="st">"species_id"</span>]) <span class="op">-</span> <span class="bu">set</span>(species[<span class="st">"species_id"</span>])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="op">{</span><span class="va">nan</span><span class="op">}</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>In practice, the values in the columns used to join two dataframes may not align exactly. Above, the surveys dataframe contains a few hundred rows where species_id is NaN. These are the rows that were dropped when the dataframes were merged.</p>
<p>By default, <code>pd.merge()</code> performs an <strong>inner join</strong>. This means that a row will only appear if the value in the shared column appears in both of the datasets being merged. In this case, that means that survey observations that don’t have a species_id or have a species_id that does not appear in the species dataframe will be dropped.</p>
<p>This is not always desirable behavior. Fortunately, pandas supports additional types of merges:</p>
<ul>
<li>
<strong>Inner:</strong> Include all rows with common values in the join column. This is the default behavior.</li>
<li>
<strong>Left:</strong> Include all rows from the left dataframe. Columns from the right dataframe are populated if a common value exists and set to NaN if not.</li>
<li>
<strong>Right:</strong> Include all rows from the right dataframe. Columns from the left dataframe are populated if a common value exists and set to NaN if not.</li>
<li>
<strong>Outer:</strong> Includes all rows from both dataframes</li>
</ul>
<p>We want to keep all of our observations, so let’s do a left join instead. To specify the type of merge, we use the <em>how</em> keyword argument:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>pd.merge(surveys, species, how<span class="op">=</span><span class="st">"left"</span>)</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
<th>
genus
</th>
<th>
species
</th>
<th>
taxa
</th>
</tr></thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
32.0
</td>
<td>
NaN
</td>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
1
</th>
<td>
2
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
NL
</td>
<td>
M
</td>
<td>
33.0
</td>
<td>
NaN
</td>
<td>
Neotoma
</td>
<td>
albigula
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
2
</th>
<td>
3
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
2
</td>
<td>
DM
</td>
<td>
F
</td>
<td>
37.0
</td>
<td>
NaN
</td>
<td>
Dipodomys
</td>
<td>
merriami
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
3
</th>
<td>
4
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
7
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
NaN
</td>
<td>
Dipodomys
</td>
<td>
merriami
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
4
</th>
<td>
5
</td>
<td>
7
</td>
<td>
16
</td>
<td>
1977
</td>
<td>
3
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
NaN
</td>
<td>
Dipodomys
</td>
<td>
merriami
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35544
</th>
<td>
35545
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
Ammospermophilus
</td>
<td>
harrisi
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
35545
</th>
<td>
35546
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
Ammospermophilus
</td>
<td>
harrisi
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
35547
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
<td>
Reithrodontomys
</td>
<td>
megalotis
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
<td>
Dipodomys
</td>
<td>
ordii
</td>
<td>
Rodent
</td>
</tr>
<tr>
<th>
35548
</th>
<td>
35549
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
5
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>
35549 rows × 12 columns
</p>
<p>Now all 35,549 rows appear in the merged dataframe.</p>
</section><section id="appending-rows-to-a-dataframe"><h2 class="section-heading">Appending rows to a dataframe<a class="anchor" aria-label="anchor" href="#appending-rows-to-a-dataframe"></a>
</h2>
<hr class="half-width">
<p>Merges address the case where information about the same set of observations is spread across multiple files. What about when the observations themselves are split into more than one file? For a survey like the one we’ve been looking at in this lesson, we might get a new file once a year with the same columns but a completely new set of observations. How can we add those new observations to our dataframe?</p>
<p>We’ll simulate this operation by splitting data from two different years, 2001 and 2002, into separate dataframes. We can do this using conditionals, as we saw in lesson 3:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>surveys_2001 <span class="op">=</span> surveys[surveys[<span class="st">"year"</span>] <span class="op">==</span> <span class="dv">2001</span>].copy()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>surveys_2001</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
31710
</th>
<td>
31711
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
26.0
</td>
<td>
25.0
</td>
</tr>
<tr>
<th>
31711
</th>
<td>
31712
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
43.0
</td>
</tr>
<tr>
<th>
31712
</th>
<td>
31713
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
PB
</td>
<td>
M
</td>
<td>
29.0
</td>
<td>
44.0
</td>
</tr>
<tr>
<th>
31713
</th>
<td>
31714
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
34.0
</td>
<td>
53.0
</td>
</tr>
<tr>
<th>
31714
</th>
<td>
31715
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
2
</td>
<td>
OT
</td>
<td>
M
</td>
<td>
20.0
</td>
<td>
27.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
33315
</th>
<td>
33316
</td>
<td>
12
</td>
<td>
16
</td>
<td>
2001
</td>
<td>
11
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
33316
</th>
<td>
33317
</td>
<td>
12
</td>
<td>
16
</td>
<td>
2001
</td>
<td>
13
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
33317
</th>
<td>
33318
</td>
<td>
12
</td>
<td>
16
</td>
<td>
2001
</td>
<td>
14
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
33318
</th>
<td>
33319
</td>
<td>
12
</td>
<td>
16
</td>
<td>
2001
</td>
<td>
15
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
33319
</th>
<td>
33320
</td>
<td>
12
</td>
<td>
16
</td>
<td>
2001
</td>
<td>
16
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>
1610 rows × 9 columns
</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>surveys_2002 <span class="op">=</span> surveys[surveys[<span class="st">"year"</span>] <span class="op">==</span> <span class="dv">2002</span>].copy()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>surveys_2002</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
33320
</th>
<td>
33321
</td>
<td>
1
</td>
<td>
12
</td>
<td>
2002
</td>
<td>
1
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
38.0
</td>
<td>
44.0
</td>
</tr>
<tr>
<th>
33321
</th>
<td>
33322
</td>
<td>
1
</td>
<td>
12
</td>
<td>
2002
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
58.0
</td>
</tr>
<tr>
<th>
33322
</th>
<td>
33323
</td>
<td>
1
</td>
<td>
12
</td>
<td>
2002
</td>
<td>
1
</td>
<td>
PB
</td>
<td>
M
</td>
<td>
28.0
</td>
<td>
45.0
</td>
</tr>
<tr>
<th>
33323
</th>
<td>
33324
</td>
<td>
1
</td>
<td>
12
</td>
<td>
2002
</td>
<td>
1
</td>
<td>
AB
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
33324
</th>
<td>
33325
</td>
<td>
1
</td>
<td>
12
</td>
<td>
2002
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
35.0
</td>
<td>
29.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35544
</th>
<td>
35545
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35545
</th>
<td>
35546
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
35547
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
</tr>
<tr>
<th>
35548
</th>
<td>
35549
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
5
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>
2229 rows × 9 columns
</p>
<p>We now have two different dataframes with the same columns but different data, one with 1,610 rows, the other with 2,229 rows. We can combine them into a new dataframe using <code>pd.concat()</code>, which stacks the dataframes vertically (that is, it appends records from the 2002 dataset to the 2001 dataset). This method accepts a list and will concatenate each item moving from left to right. We’re only combining two dataframes here but could do more if needed.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>surveys_2001_2002 <span class="op">=</span> pd.concat([surveys_2001, surveys_2002])</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>surveys_2001_2002</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
</tr></thead>
<tbody>
<tr>
<th>
31710
</th>
<td>
31711
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
26.0
</td>
<td>
25.0
</td>
</tr>
<tr>
<th>
31711
</th>
<td>
31712
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
43.0
</td>
</tr>
<tr>
<th>
31712
</th>
<td>
31713
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
PB
</td>
<td>
M
</td>
<td>
29.0
</td>
<td>
44.0
</td>
</tr>
<tr>
<th>
31713
</th>
<td>
31714
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
34.0
</td>
<td>
53.0
</td>
</tr>
<tr>
<th>
31714
</th>
<td>
31715
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
2
</td>
<td>
OT
</td>
<td>
M
</td>
<td>
20.0
</td>
<td>
27.0
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35544
</th>
<td>
35545
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35545
</th>
<td>
35546
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
35547
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
</tr>
<tr>
<th>
35548
</th>
<td>
35549
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
5
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
<p>
3839 rows × 9 columns
</p>
<p>The combined dataframe includes all rows from both dataframes.</p>
<p>In some cases, the exact columns may change from year to year even within the same project. For example, researchers may decide to add an additional column to track a new piece of data or to provide a quality check. If a column is present in only one dataset, you can still concatenate the datasets. Any column that does not appear in a given dataset will be set to NaN for those rows in the combined dataframe.</p>
<p>To illustrate this, we’ll add a validated column to the 2002 survey, then re-run <code>pd.concat()</code>:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>surveys_2002[<span class="st">"validated"</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>surveys_2001_2002 <span class="op">=</span> pd.concat([surveys_2001, surveys_2002])</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>surveys_2001_2002</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
record_id
</th>
<th>
month
</th>
<th>
day
</th>
<th>
year
</th>
<th>
plot_id
</th>
<th>
species_id
</th>
<th>
sex
</th>
<th>
hindfoot_length
</th>
<th>
weight
</th>
<th>
validated
</th>
</tr></thead>
<tbody>
<tr>
<th>
31710
</th>
<td>
31711
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
PB
</td>
<td>
F
</td>
<td>
26.0
</td>
<td>
25.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
31711
</th>
<td>
31712
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
DM
</td>
<td>
M
</td>
<td>
37.0
</td>
<td>
43.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
31712
</th>
<td>
31713
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
PB
</td>
<td>
M
</td>
<td>
29.0
</td>
<td>
44.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
31713
</th>
<td>
31714
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
1
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
34.0
</td>
<td>
53.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
31714
</th>
<td>
31715
</td>
<td>
1
</td>
<td>
21
</td>
<td>
2001
</td>
<td>
2
</td>
<td>
OT
</td>
<td>
M
</td>
<td>
20.0
</td>
<td>
27.0
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35544
</th>
<td>
35545
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
True
</td>
</tr>
<tr>
<th>
35545
</th>
<td>
35546
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
15
</td>
<td>
AH
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
True
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
35547
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
10
</td>
<td>
RM
</td>
<td>
F
</td>
<td>
15.0
</td>
<td>
14.0
</td>
<td>
True
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
35548
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
7
</td>
<td>
DO
</td>
<td>
M
</td>
<td>
36.0
</td>
<td>
51.0
</td>
<td>
True
</td>
</tr>
<tr>
<th>
35548
</th>
<td>
35549
</td>
<td>
12
</td>
<td>
31
</td>
<td>
2002
</td>
<td>
5
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
True
</td>
</tr>
</tbody>
</table>
<p>
3839 rows × 10 columns
</p>
<p>As expected, the validated column has a value of NaN for the 2001 data in the combined dataframe.</p>
</section><section id="joining-and-splitting-columns"><h2 class="section-heading">Joining and splitting columns<a class="anchor" aria-label="anchor" href="#joining-and-splitting-columns"></a>
</h2>
<hr class="half-width">
<p>Sometimes we’d like to combine values from two or more columns into a single column. For example, we might want to refer to the species in each record by both its genus and species names. In Python, we use the <code>+</code> operator to concatenate (or join) strings, and pandas works the same way:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>species[<span class="st">"genus_species"</span>] <span class="op">=</span> species[<span class="st">"genus"</span>] <span class="op">+</span> <span class="st">" "</span> <span class="op">+</span> species[<span class="st">"species"</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>species[<span class="st">"genus_species"</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0                Amphispiza bilineata
1            Ammospermophilus harrisi
2               Ammodramus savannarum
3                     Baiomys taylori
4     Campylorhynchus brunneicapillus
5             Calamospiza melanocorys
6                 Callipepla squamata
7                 Crotalus scutalatus
8                Cnemidophorus tigris
9             Cnemidophorus uniparens
10                   Crotalus viridis
11                 Dipodomys merriami
12                    Dipodomys ordii
13              Dipodomys spectabilis
14                      Dipodomys sp.
15                  Eumeces obsoletus
16                     Gambelia silus
17                   Neotoma albigula
18                        Neotoma sp.
19              Onychomys leucogaster
20                 Onychomys torridus
21                      Onychomys sp.
22                Chaetodipus baileyi
23                   Pipilo chlorurus
24                Peromyscus eremicus
25                 Perognathus flavus
26                Pooecetes gramineus
27               Perognathus hispidus
28            Chaetodipus intermedius
29                Peromyscus leucopus
30             Peromyscus maniculatus
31           Chaetodipus penicillatus
32                      Pipilo fuscus
33                    Chaetodipus sp.
34         Reithrodontomys fulvescens
35          Reithrodontomys megalotis
36           Reithrodontomys montanus
37                Reithrodontomys sp.
38               Sylvilagus audubonii
39                   Spizella breweri
40                  Sceloporus clarki
41               Sigmodon fulviventer
42                  Sigmodon hispidus
43              Sigmodon ochrognathus
44             Spermophilus spilosoma
45          Spermophilus tereticaudus
46               Sceloporus undulatus
47                       Sigmodon sp.
48                         Lizard sp.
49                         Pipilo sp.
50                         Rodent sp.
51                        Sparrow sp.
52             Zonotrichia leucophrys
53                   Zenaida macroura
Name: genus_species, dtype: object</code></pre>
</div>
<p>Note that the <code>+</code> operator is also used to add numeric columns. In Python, the same operator can be used to perform different operations for different data types (but keep reading for an important caveat.)</p>
<p>Another common need is to join or split dates. In the ecology dataset, the date is split across year, month, and day columns. However, pandas has a special data type, <code>datetime64</code>, for representing dates that is useful for plotting, comparing, and resampling time series data. To make use of that functionality, we can concatenate the date columns and convert them to a datetime object. For clarity, we’ll use an unambiguous date format: YYYY-MM-DD.</p>
<p>We need to perform an additional step before combining the date columns. Year, month, and day are all stored as integers in our dataframe (specifically, they use the <code>int64</code> data type). If we try to concatenate them as they are, we’ll receive an error. This is because the <code>+</code> operator only works when each object has a similar type, that is, all objects are either the same type or can be coerced to a common type (like <code>int</code> and <code>float</code>, which are distinct types that generally play well together). In this case, the columns are integers and the hyphens are strings. pandas cannot determine exactly how the user wants to combine the values, so it gives an error.</p>
<p>To resolve the error, we can use the <code>astype()</code> method to convert each column to a string before combining the columns:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>year <span class="op">=</span> surveys[<span class="st">"year"</span>].astype(<span class="bu">str</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>month <span class="op">=</span> surveys[<span class="st">"month"</span>].astype(<span class="bu">str</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>day <span class="op">=</span> surveys[<span class="st">"day"</span>].astype(<span class="bu">str</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>surveys[<span class="st">"date"</span>] <span class="op">=</span> year <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> month <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> day</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>surveys[<span class="st">"date"</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0         1977-7-16
1         1977-7-16
2         1977-7-16
3         1977-7-16
4         1977-7-16
            ...    
35544    2002-12-31
35545    2002-12-31
35546    2002-12-31
35547    2002-12-31
35548    2002-12-31
Name: date, Length: 35549, dtype: object</code></pre>
</div>
<p>Note that some of the dates look a little funny because single-digit days and months do not include a leading zero. For example, in the first row we have <strong>1977-7-16</strong> instead of <strong>1977-07-16</strong>. This is usually not a big deal but can be neatened up using the <code>str</code> accessor.</p>
<p>In pandas, an accessor is an attribute that provides additional functionality to an object. Here, the <code>str</code> accessor allows us to access many of the methods from the built-in <code>str</code> data type, including <code>zfill()</code>, which pads a string to a given length by adding zeroes to the start of the string:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> <span class="st">"2"</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>text.zfill(<span class="dv">3</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="st">'002'</span></span></code></pre>
</div>
<p>Using the <code>str</code> accessor, we can use that method to zero-pad the data in a <code>Series</code>:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pad month and day to two characters</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>month <span class="op">=</span> month.<span class="bu">str</span>.zfill(<span class="dv">2</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>day <span class="op">=</span> day.<span class="bu">str</span>.zfill(<span class="dv">2</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>surveys[<span class="st">"date"</span>] <span class="op">=</span> year <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> month <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> day</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>surveys[<span class="st">"date"</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0        1977-07-16
1        1977-07-16
2        1977-07-16
3        1977-07-16
4        1977-07-16
            ...    
35544    2002-12-31
35545    2002-12-31
35546    2002-12-31
35547    2002-12-31
35548    2002-12-31
Name: date, Length: 35549, dtype: object</code></pre>
</div>
<p>The month and date values in date are now padded to a length of two, allowing us to create a well-formed YYYY-MM-DD date string. Other string methods, like <code>upper()</code> and <code>lower()</code>, can be used in the same way.</p>
<p>Before we convert the date column to a datetime, we’re going to use the date string to show the opposite operation: Splitting a value stored in one column into multiple columns. One way to do this in pandas is to use <code>str.split()</code>, which splits each value in a series based on a <em>delimiter</em>, a character used as a boundary between parts of a string. Here, a hyphen is used to delimit the year, month, and date in each date. By splitting the column on a hyphen, we can extract each of those components into its own column. We also pass <code>True</code> to the <em>expand</em> keyword argument, which makes the <code>str.split()</code> method return a dataframe:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>surveys[<span class="st">"date"</span>].<span class="bu">str</span>.split(<span class="st">"-"</span>, expand<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead><tr style="text-align: right;">
<th>
</th>
<th>
0
</th>
<th>
1
</th>
<th>
2
</th>
</tr></thead>
<tbody>
<tr>
<th>
0
</th>
<td>
1977
</td>
<td>
07
</td>
<td>
16
</td>
</tr>
<tr>
<th>
1
</th>
<td>
1977
</td>
<td>
07
</td>
<td>
16
</td>
</tr>
<tr>
<th>
2
</th>
<td>
1977
</td>
<td>
07
</td>
<td>
16
</td>
</tr>
<tr>
<th>
3
</th>
<td>
1977
</td>
<td>
07
</td>
<td>
16
</td>
</tr>
<tr>
<th>
4
</th>
<td>
1977
</td>
<td>
07
</td>
<td>
16
</td>
</tr>
<tr>
<th>
…
</th>
<td>
…
</td>
<td>
…
</td>
<td>
…
</td>
</tr>
<tr>
<th>
35544
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
</tr>
<tr>
<th>
35545
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
</tr>
<tr>
<th>
35546
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
</tr>
<tr>
<th>
35547
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
</tr>
<tr>
<th>
35548
</th>
<td>
2002
</td>
<td>
12
</td>
<td>
31
</td>
</tr>
</tbody>
</table>
<p>
35549 rows × 3 columns
</p>
<p>Now let’s go ahead and convert our date column into a datetime object using <code>pd.to_datetime()</code>:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>surveys[<span class="st">"date"</span>] <span class="op">=</span> pd.to_datetime(surveys[<span class="st">"date"</span>])</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>surveys[<span class="st">"date"</span>]</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0       1977-07-16
1       1977-07-16
2       1977-07-16
3       1977-07-16
4       1977-07-16
           ...    
35544   2002-12-31
35545   2002-12-31
35546   2002-12-31
35547   2002-12-31
35548   2002-12-31
Name: date, Length: 35549, dtype: datetime64[ns]</code></pre>
</div>
<div id="challenge3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<p>pandas can help us ask specific questions which we want to answer about our data. The real skill is to know how to translate our scientific questions into a sensible approach (and subsequently visualize and interpret our results).</p>
<p>Try using pandas to answer the following questions.</p>
<ol style="list-style-type: decimal">
<li>How many specimens of each sex are there for each year, including those whose sex is unknown?</li>
<li>What is the average weight of each taxa?</li>
<li>What are the minimum, maximum and average weight for each species of Rodent?</li>
<li>What is the average hindfoot length for male and female rodent of each species? Is there a male/female difference?</li>
<li>What is the average weight of each rodent species over the course of the years? Is there any noticeable trend for any of the species?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Show me the solution to challenge 1
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>How many specimens of each sex are there for each year, including those whose sex is unknown?</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill in NaN values in sex with U</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>surveys[<span class="st">"sex"</span>] <span class="op">=</span> surveys[<span class="st">"sex"</span>].fillna(<span class="st">"U"</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Count records by sex</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> surveys.groupby([<span class="st">"year"</span>, <span class="st">"sex"</span>])[<span class="st">"record_id"</span>].count()</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the option_context context manager to show all rows</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pd.option_context(<span class="st">"display.max_rows"</span>, <span class="va">None</span>):</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(result)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>year  sex
1977  F       204
      M       214
      U        85
1978  F       503
      M       433
      U       112
1979  F       327
      M       324
      U        68
1980  F       605
      M       727
      U        83
1981  F       631
      M       745
      U        96
1982  F       823
      M      1027
      U       128
1983  F       771
      M       797
      U       105
1984  F       445
      M       443
      U        93
1985  F       636
      M       716
      U        86
1986  F       414
      M       455
      U        73
1987  F       677
      M       862
      U       132
1988  F       604
      M       737
      U       128
1989  F       678
      M       780
      U       111
1990  F       581
      M       636
      U        94
1991  F       606
      M       637
      U       104
1992  F       443
      M       477
      U       118
1993  F       285
      M       380
      U        85
1994  F       243
      M       327
      U        98
1995  F       574
      M       534
      U       114
1996  F       725
      M       910
      U        71
1997  F      1071
      M      1357
      U        65
1998  F       717
      M       798
      U        95
1999  F       545
      M       530
      U        60
2000  F       690
      M       779
      U        83
2001  F       743
      M       744
      U       123
2002  F      1149
      M       979
      U       101
Name: record_id, dtype: int64
</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Show me the solution to challenge 2
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>What is the average weight of each taxa?</p>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the merged dataframe</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> pd.merge(surveys, species, how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by taxa</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> merged.groupby(<span class="st">"taxa"</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the min, max, and mean weight</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>grouped[<span class="st">"weight"</span>].mean()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>taxa
Bird             NaN
Rabbit           NaN
Reptile          NaN
Rodent     42.672428
Name: weight, dtype: float64</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Show me the solution to challenge 3
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<p>What are the minimum, maximum and average weight for each species of Rodent?</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the merged dataframe</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> pd.merge(surveys, species, how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Limit merged dataframe to rodents</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>rodents <span class="op">=</span> merged[merged[<span class="st">"taxa"</span>] <span class="op">==</span> <span class="st">"Rodent"</span>]</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Group rodents by species</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> rodents.groupby(<span class="st">"species_id"</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the min, max, and mean weight</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>grouped.agg({<span class="st">"weight"</span>: [<span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"mean"</span>]})</span></code></pre>
</div>
<style>
  table.dataframe tbody tr:hover { background-color: #ccffff !important; }
  table.dataframe tr:nth-child(even) { background-color: #f5f5f5; }
  table.dataframe th { text-align: right; font-weight: bold; }
  table.dataframe td { text-align: right; }
</style>
<table border="1" class="table dataframe">
<thead>
<tr>
<th>
</th>
<th colspan="3" halign="left">
weight
</th>
</tr>
<tr>
<th>
</th>
<th>
min
</th>
<th>
max
</th>
<th>
mean
</th>
</tr>
<tr>
<th>
species_id
</th>
<th>
</th>
<th>
</th>
<th>
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
AH
</th>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
BA
</th>
<td>
6.0
</td>
<td>
18.0
</td>
<td>
8.600000
</td>
</tr>
<tr>
<th>
DM
</th>
<td>
10.0
</td>
<td>
66.0
</td>
<td>
43.157864
</td>
</tr>
<tr>
<th>
DO
</th>
<td>
12.0
</td>
<td>
76.0
</td>
<td>
48.870523
</td>
</tr>
<tr>
<th>
DS
</th>
<td>
12.0
</td>
<td>
190.0
</td>
<td>
120.130546
</td>
</tr>
<tr>
<th>
DX
</th>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
NL
</th>
<td>
30.0
</td>
<td>
280.0
</td>
<td>
159.245660
</td>
</tr>
<tr>
<th>
OL
</th>
<td>
10.0
</td>
<td>
56.0
</td>
<td>
31.575258
</td>
</tr>
<tr>
<th>
OT
</th>
<td>
5.0
</td>
<td>
46.0
</td>
<td>
24.230556
</td>
</tr>
<tr>
<th>
OX
</th>
<td>
18.0
</td>
<td>
24.0
</td>
<td>
21.000000
</td>
</tr>
<tr>
<th>
PB
</th>
<td>
12.0
</td>
<td>
55.0
</td>
<td>
31.735943
</td>
</tr>
<tr>
<th>
PE
</th>
<td>
8.0
</td>
<td>
40.0
</td>
<td>
21.586508
</td>
</tr>
<tr>
<th>
PF
</th>
<td>
4.0
</td>
<td>
25.0
</td>
<td>
7.923127
</td>
</tr>
<tr>
<th>
PH
</th>
<td>
18.0
</td>
<td>
48.0
</td>
<td>
31.064516
</td>
</tr>
<tr>
<th>
PI
</th>
<td>
17.0
</td>
<td>
21.0
</td>
<td>
19.250000
</td>
</tr>
<tr>
<th>
PL
</th>
<td>
8.0
</td>
<td>
27.0
</td>
<td>
19.138889
</td>
</tr>
<tr>
<th>
PM
</th>
<td>
7.0
</td>
<td>
49.0
</td>
<td>
21.364155
</td>
</tr>
<tr>
<th>
PP
</th>
<td>
4.0
</td>
<td>
74.0
</td>
<td>
17.173942
</td>
</tr>
<tr>
<th>
PX
</th>
<td>
18.0
</td>
<td>
20.0
</td>
<td>
19.000000
</td>
</tr>
<tr>
<th>
RF
</th>
<td>
9.0
</td>
<td>
20.0
</td>
<td>
13.386667
</td>
</tr>
<tr>
<th>
RM
</th>
<td>
4.0
</td>
<td>
29.0
</td>
<td>
10.585010
</td>
</tr>
<tr>
<th>
RO
</th>
<td>
8.0
</td>
<td>
13.0
</td>
<td>
10.250000
</td>
</tr>
<tr>
<th>
RX
</th>
<td>
11.0
</td>
<td>
20.0
</td>
<td>
15.500000
</td>
</tr>
<tr>
<th>
SF
</th>
<td>
24.0
</td>
<td>
199.0
</td>
<td>
58.878049
</td>
</tr>
<tr>
<th>
SH
</th>
<td>
16.0
</td>
<td>
140.0
</td>
<td>
73.148936
</td>
</tr>
<tr>
<th>
SO
</th>
<td>
15.0
</td>
<td>
105.0
</td>
<td>
55.414634
</td>
</tr>
<tr>
<th>
SS
</th>
<td>
57.0
</td>
<td>
130.0
</td>
<td>
93.500000
</td>
</tr>
<tr>
<th>
ST
</th>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
<tr>
<th>
UR
</th>
<td>
NaN
</td>
<td>
NaN
</td>
<td>
NaN
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  Show me the solution to challenge 4
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<p>What is the average hindfoot length for male and female rodent of each species? Is there a male/female difference?</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the merged dataframe</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> pd.merge(surveys, species, how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Limit merged dataframe to rodents</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>rodents <span class="op">=</span> merged[merged[<span class="st">"taxa"</span>] <span class="op">==</span> <span class="st">"Rodent"</span>]</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Group rodents by species and sex</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> rodents.groupby([<span class="st">"species_id"</span>, <span class="st">"sex"</span>])</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean hindfoot length, plus count and standard deviation</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># to better assess the question</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pd.option_context(<span class="st">"display.max_rows"</span>, <span class="va">None</span>):</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(grouped[<span class="st">"hindfoot_length"</span>].agg([<span class="st">"count"</span>, <span class="st">"mean"</span>, <span class="st">"std"</span>]))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                count       mean        std
species_id sex                             
AH         M        0        NaN        NaN
           U        2  33.000000   2.828427
BA         F       31  13.161290   1.529636
           M       14  12.642857   2.097880
           U        0        NaN        NaN
DM         F     4302  35.712692   1.433067
           M     5658  36.188229   1.455396
           U       12  35.583333   0.996205
DO         F     1244  35.486334   1.726414
           M     1640  35.698780   1.611656
           U        3  36.000000   0.000000
DS         F     1046  49.583174   1.973573
           M     1083  50.301939   2.128120
           U        3  50.000000   1.732051
DX         U        0        NaN        NaN
NL         F      620  32.024194   1.669181
           M      452  32.577434   1.903603
           U        2  52.000000  25.455844
OL         F      438  20.287671   1.101022
           M      480  20.758333   1.651195
           U        2  20.000000   0.000000
OT         F     1019  20.281649   1.519412
           M     1115  20.257399   1.087354
           U        5  19.600000   1.140175
OX         F        3  19.666667   1.154701
           M        5  18.800000   3.346640
           U        0        NaN        NaN
PB         F     1645  25.882675   0.928842
           M     1213  26.431987   1.444130
           U        6  26.166667   0.983192
PE         F      544  20.272059   1.156084
           M      666  20.132132   1.177721
           U        2  20.500000   0.707107
PF         F      721  15.550624   1.381627
           M      770  15.620779   1.142208
           U        2  13.000000   4.242641
PH         F       20  25.900000   1.293709
           M       11  25.545455   1.752920
PI         M        8  22.500000   0.534522
           U        1  20.000000        NaN
PL         F       16  19.750000   2.720294
           M       19  20.263158   0.933459
           U        1  20.000000        NaN
PM         F      361  20.279778   1.162782
           M      483  20.530021   1.275621
           U        3  21.333333   4.041452
PP         F     1574  21.676620   1.316529
           M     1444  21.838643   1.201006
           U        9  20.888889   2.027588
PX         F        1  19.000000        NaN
           M        1  20.000000        NaN
           U        0        NaN        NaN
RF         F       55  17.527273   0.813191
           M       18  17.500000   0.985184
RM         F     1133  16.391880   1.123946
           M     1296  16.491512   1.134202
           U       13  15.846154   2.444250
RO         F        4  14.750000   0.957427
           M        4  16.000000   1.154701
RX         M        2  18.500000   2.121320
SF         F       16  27.500000   2.683282
           M       23  26.347826   3.524056
           U        2  24.500000   0.707107
SH         F       71  29.028169   2.298893
           M       60  27.983333   2.801281
           U        0        NaN        NaN
SO         F       30  25.633333   4.139660
           M       11  25.727273   1.954017
SS         F        0        NaN        NaN
           M        0        NaN        NaN
           U        0        NaN        NaN
ST         U        0        NaN        NaN
UR         U        0        NaN        NaN
</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">
  Show me the solution to challenge 5
  </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">
<p>What is the average weight of each rodent species over the course of the years? Is there any noticeable trend for any of the species?</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the merged dataframe</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> pd.merge(surveys, species, how<span class="op">=</span><span class="st">"left"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Limit merged dataframe to rodents</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>rodents <span class="op">=</span> merged[merged[<span class="st">"taxa"</span>] <span class="op">==</span> <span class="st">"Rodent"</span>]</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Group rodents by species and year</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> rodents.groupby([<span class="st">"species_id"</span>, <span class="st">"year"</span>])</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean weight by year</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> grouped[<span class="st">"weight"</span>].mean()</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the option_context context manager to show all rows</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pd.option_context(<span class="st">"display.max_rows"</span>, <span class="va">None</span>):</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(result)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>species_id  year
AH          1978           NaN
            1982           NaN
            1983           NaN
            1984           NaN
            1985           NaN
            1986           NaN
            1987           NaN
            1988           NaN
            1989           NaN
            1990           NaN
            1991           NaN
            1992           NaN
            1993           NaN
            1994           NaN
            1995           NaN
            1996           NaN
            1997           NaN
            1998           NaN
            1999           NaN
            2000           NaN
            2001           NaN
            2002           NaN
BA          1989      7.000000
            1990      8.000000
            1991      9.240000
            1992      7.833333
DM          1977     41.141304
            1978     40.795455
            1979     43.507317
            1980     44.136082
            1981     44.032907
            1982     41.975042
            1983     40.944551
            1984     40.765306
            1985     41.507645
            1986     43.361596
            1987     43.232609
            1988     43.397790
            1989     44.349206
            1990     41.769912
            1991     43.148338
            1992     43.877966
            1993     43.373984
            1994     42.373288
            1995     44.806147
            1996     44.506173
            1997     44.708551
            1998     43.131403
            1999     43.945402
            2000     43.126638
            2001     45.442177
            2002     46.168317
DO          1977     42.666667
            1978     45.000000
            1979     45.862069
            1980     48.058824
            1981     49.111111
            1982     47.919643
            1983     47.150602
            1984     48.415094
            1985     47.956731
            1986     49.372727
            1987     50.087379
            1988     51.463768
            1989     51.025641
            1990     48.512048
            1991     49.695652
            1992     48.367816
            1993     48.461538
            1994     47.750000
            1995     49.592593
            1996     47.234940
            1997     48.177866
            1998     49.731183
            1999     48.012048
            2000     49.224719
            2001     52.233766
            2002     49.514403
DS          1977    121.437500
            1978    115.198653
            1979    111.796954
            1980    120.725664
            1981    125.818444
            1982    115.647929
            1983    122.033088
            1984    124.082192
            1985    124.326316
            1986    128.071429
            1987    126.383838
            1988    129.490566
            1989    121.896552
            1990    121.187500
            1991    113.000000
            1992    112.352941
            1993    105.722222
            1994    106.625000
            1997    111.000000
            1998    116.000000
            1999    120.714286
DX          1980           NaN
            1983           NaN
            1986           NaN
            1988           NaN
            1991           NaN
            1992           NaN
            1993           NaN
            1994           NaN
            1995           NaN
            1996           NaN
            1998           NaN
            1999           NaN
            2000           NaN
            2001           NaN
            2002           NaN
NL          1977           NaN
            1978    184.656250
            1979    138.000000
            1980    158.982143
            1981    165.903226
            1982    160.613208
            1983    156.691489
            1984    150.095238
            1985    148.829268
            1986    159.724138
            1987    158.840000
            1988    163.104167
            1989    151.278689
            1990    154.275862
            1991    148.785714
            1992    139.000000
            1993    127.391304
            1994    186.875000
            1995    155.833333
            1996    148.000000
            1997    150.688889
            1998    159.466667
            1999    182.200000
            2000    179.307692
            2001    167.851064
            2002    182.159091
OL          1977     21.666667
            1978     31.027027
            1979     33.717391
            1980     33.107143
            1981     33.296296
            1982     35.590361
            1983     34.584615
            1984     32.550725
            1985     32.108696
            1986     30.880952
            1987     30.779221
            1988     30.306122
            1989     31.947368
            1990     31.200000
            1991     28.171429
            1992     28.454545
            1993     27.545455
            1994     21.900000
            1995     27.296296
            1996     27.769231
            1997     33.625000
            2002     25.428571
OT          1977     21.000000
            1978     23.220000
            1979     23.075758
            1980     24.083333
            1981     24.415385
            1982     24.925532
            1983     24.697674
            1984     22.416667
            1985     22.064516
            1986     21.500000
            1987     23.069767
            1988     24.070588
            1989     24.663366
            1990     23.675325
            1991     24.588235
            1992     24.928571
            1993     22.363636
            1994     25.285714
            1995     24.868421
            1996     23.453704
            1997     24.785156
            1998     24.675676
            1999     25.723810
            2000     25.303448
            2001     23.707792
            2002     23.833333
OX          1977     21.333333
            1978           NaN
            1982     24.000000
            1984     18.000000
            1989     20.000000
            1993           NaN
PB          1995     34.000000
            1996     32.578947
            1997     31.085603
            1998     30.082237
            1999     31.710037
            2000     30.878899
            2001     32.798851
            2002     32.359447
PE          1977     19.500000
            1978     20.428571
            1979     20.529412
            1980     22.450000
            1981     20.558140
            1982     21.173077
            1983     20.864865
            1984     20.210526
            1985     20.360000
            1986     22.520000
            1987     21.625899
            1988     22.625668
            1989     21.935673
            1990     21.671233
            1991     21.435484
            1992     22.750000
            1993     19.230769
            1994     18.000000
            1995     21.230769
            1996     22.027778
            1997     20.929825
            1998     20.304348
            1999     25.428571
            2000     21.615385
            2001     20.400000
            2002     21.719298
PF          1977      7.173913
            1978      7.088235
            1979      7.529412
            1980      7.455556
            1981      7.152542
            1982      6.918919
            1983      6.833333
            1984      7.428571
            1985           NaN
            1986      8.000000
            1987      7.500000
            1988      8.000000
            1989      7.230769
            1990      7.117647
            1991      7.827586
            1992      8.767857
            1993      8.238806
            1994      7.855072
            1995      8.780645
            1996      8.393846
            1997      8.448649
            1998      8.720000
            2001      8.538462
            2002      7.388889
PH          1984     28.000000
            1985     32.666667
            1986     39.000000
            1988     33.000000
            1989     30.500000
            1990     31.142857
            1992     31.142857
            1995     35.333333
            1997     22.000000
PI          1992     18.000000
            1995           NaN
            2001     18.000000
            2002     20.000000
PL          1995     22.333333
            1996     21.166667
            1997     18.789474
            1998     16.714286
            2000     21.000000
PM          1978     20.666667
            1979     23.666667
            1980     21.000000
            1981     19.933333
            1982     21.391304
            1983     22.023810
            1984     19.545455
            1985     19.000000
            1986     21.696970
            1987     22.297710
            1988     21.759259
            1989     20.222222
            1995     27.375000
            1996     20.224490
            1997     21.126394
            1998     20.591398
            1999     22.523810
            2000     20.500000
            2001     26.666667
            2002     19.000000
PP          1977     15.333333
            1978     14.869565
            1979     15.105263
            1980     14.176471
            1981     13.950000
            1982     16.125000
            1983     15.468750
            1984     15.307692
            1985     15.764706
            1986     16.750000
            1987     17.840909
            1988     18.280000
            1989     17.409091
            1990     16.029412
            1991     17.904762
            1992     17.479675
            1993     17.954023
            1994     17.585714
            1995     16.844444
            1996     18.095563
            1997     18.175000
            1998     16.266990
            1999     16.521212
            2000     16.788618
            2001     17.752896
            2002     17.018617
PX          1996           NaN
            1997     19.000000
            1998           NaN
            2000           NaN
RF          1982     11.500000
            1988     13.818182
            1989     13.346939
            1990     12.916667
            1997     20.000000
RM          1977     10.000000
            1978      7.500000
            1979      8.333333
            1980     10.227273
            1981     11.178571
            1982     10.436242
            1983      9.872000
            1984     11.152542
            1985      8.371429
            1986     10.750000
            1987     10.657609
            1988     10.322115
            1989     10.411311
            1990     10.305677
            1991     10.498305
            1992     10.904762
            1993     10.747475
            1994     10.675000
            1995     12.653846
            1996     11.455556
            1997     11.230769
            1998     13.100000
            1999     10.555556
            2000     11.400000
            2001     11.333333
            2002     10.000000
RO          1991     11.000000
            2002     10.142857
RX          1995     20.000000
            1997     11.000000
SF          1989     54.800000
            1990     52.611111
            1991     93.166667
            1992     43.000000
            1993     44.000000
            2002     62.166667
SH          1977           NaN
            1978     89.000000
            1982     79.000000
            1983           NaN
            1986     55.000000
            1987     73.800000
            1988     72.806452
            1989     76.345455
            1990     76.888889
            1991     63.000000
            1997     50.857143
            1999     54.000000
            2000     73.375000
            2001     79.900000
            2002     64.666667
SO          1991     53.909091
            1992     55.263158
            1993     55.600000
            1994     62.333333
            1997     54.666667
SS          1977           NaN
            1978    130.000000
            1979           NaN
            1980           NaN
            1981     57.000000
            1982           NaN
            1983           NaN
            1984           NaN
            1985           NaN
            1986           NaN
            1987           NaN
            1988           NaN
            1989           NaN
            1990           NaN
            1991           NaN
            1992           NaN
            1993           NaN
            1994           NaN
            1995           NaN
            1996           NaN
            1997           NaN
            1998           NaN
            1999           NaN
            2000           NaN
            2001           NaN
            2002           NaN
ST          1993           NaN
UR          1987           NaN
            1988           NaN
            1991           NaN
            1992           NaN
            1994           NaN
            2001           NaN
            2002           NaN
Name: weight, dtype: float64
</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#NA"></a>
</h3>
<div class="callout-content">
<ul>
<li>Combine two dataframes on one or more common values using <code>pd.merge()</code>
</li>
<li>Append rows from one dataframe to another using <code>pd.concat()</code>
</li>
<li>Combine multiple text columns into one using the <code>+</code> operator</li>
<li>Use the <code>str</code> accessor to use string methods like <code>split()</code> and <code>zfill()</code> on text columns</li>
<li>Convert date strings to datetime objects using <code>pd.to_datetime()</code>
</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
				<p><a href="https://github.com/adamancer/python-ecology-lesson-alt/edit/main/README.md" class="external-link">Edit on Github</a> | <a href="https://github.com/adamancer/python-ecology-lesson-alt/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> | <a href="https://github.com/adamancer/python-ecology-lesson-alt/" class="external-link">Source</a></p>
				<p><a href="https://github.com/adamancer/python-ecology-lesson-alt/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:mansura@si.edu">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="../LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.9.5" class="external-link">sandpaper (0.9.5)</a>,
        <a href="https://github.com/carpentries/pegboard" class="external-link">pegboard (0.3.1)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.2.4" class="external-link">varnish (0.2.4)</a>.</p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://adamancer.github.io/python-ecology-lesson-alt/instructor/aio.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "python, pandas, software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://adamancer.github.io/python-ecology-lesson-alt/instructor/aio.html",
  "identifier": "https://adamancer.github.io/python-ecology-lesson-alt/instructor/aio.html",
  "dateCreated": "2022-05-10",
  "dateModified": "2022-09-06",
  "datePublished": "2022-09-06"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo --><script>
          var _paq = window._paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
          _paq.push(["setDoNotTrack", true]);
          _paq.push(["disableCookies"]);
          _paq.push(['trackPageView']);
          _paq.push(['enableLinkTracking']);
          (function() {
              var u="https://carpentries.matomo.cloud/";
              _paq.push(['setTrackerUrl', u+'matomo.php']);
              _paq.push(['setSiteId', '1']);
              var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
              g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
          })();
        </script><!-- End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

